(()=>{"use strict";var e;!function(e){e[e.FallingTickProcessed=0]="FallingTickProcessed",e[e.GameOver=1]="GameOver",e[e.FiguresMoved=2]="FiguresMoved",e[e.LevelUp=3]="LevelUp",e[e.FiguresSpawned=4]="FiguresSpawned"}(e||(e={}));var t,n=function(){function t(e,t,n,i){this.gameData=e,this.transferredToMatrixFigures=t,this.squashedLines=n,this.droppedLines=i}return t.prototype.getEventType=function(){return e.FallingTickProcessed},t}(),i=function(){function t(e){this.gameData=e}return t.prototype.getEventType=function(){return e.GameOver},t}(),r=function(){function t(e){this.gameData=e}return t.prototype.getEventType=function(){return e.FiguresMoved},t}(),o=function(){function t(e,t){this.gameData=e,this.newFigures=t}return t.prototype.getEventType=function(){return e.FiguresSpawned},t}(),a=function(){function e(){this.handlers=new Map}return e.prototype.on=function(e,t,n){void 0===n&&(n=!0);var i=this.handlers.get(e)||[];n&&i.some((function(e){return e===t}))||(i.push(t),this.handlers.set(e,i))},e.prototype.off=function(e,t){var n=this.handlers.get(e)||[],i=n.indexOf(t);i>0&&n.splice(i,1),this.handlers.set(e,n)},e.prototype.fire=function(e){(this.handlers.get(e.getEventType())||[]).forEach((function(t){t(e)}))},e}();!function(e){e[e.InitGame=0]="InitGame",e[e.ResumeGame=1]="ResumeGame",e[e.PauseGame=2]="PauseGame",e[e.FiguresFallTick=3]="FiguresFallTick",e[e.GameOver=4]="GameOver",e[e.Render=5]="Render",e[e.MoveLeft=6]="MoveLeft",e[e.MoveRight=7]="MoveRight",e[e.TurnClockwise=8]="TurnClockwise",e[e.MoveDown=9]="MoveDown",e[e.FiguresFallDown=10]="FiguresFallDown"}(t||(t={}));var s,u,l=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.InitGame},e}(),c=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.ResumeGame},e}(),h=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.PauseGame},e}(),f=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.FiguresFallTick},e}(),d=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.GameOver},e}(),m=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.Render},e}(),p=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.MoveLeft},e}(),g=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.MoveRight},e}(),v=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.TurnClockwise},e}(),y=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.MoveDown},e}(),w=function(){function e(e){this.gameData=e}return e.prototype.getCommandType=function(){return t.FiguresFallDown},e}(),F=function(){function e(){this.handlers=new Map}return e.prototype.addHandler=function(e,t,n){void 0===n&&(n=!0);var i=this.handlers.get(e)||[];n&&i.some((function(e){return e===t}))||(i.push(t),this.handlers.set(e,i))},e.prototype.removeHandler=function(e,t){var n=this.handlers.get(e)||[],i=n.indexOf(t);i>0&&n.splice(i,1),this.handlers.set(e,n)},e.prototype.run=function(e){(this.handlers.get(e.getCommandType())||[]).forEach((function(t){t(e)}))},e}(),T=(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){e[e.One=0]="One",e[e.Two=1]="Two",e[e.Three=2]="Three",e[e.Four=3]="Four"}(u||(u={}));var D,C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getNormalizedFigure=function(){var e=this.getFigure(),t=e.reduce((function(e,t){return Math.max(e,t.length)}),0);return e.map((function(e){var n=e.length;return e.length=t,e.fill(!1,n-1,t-1)}))},t.prototype.getFirstTurn=function(){return this.getNormalizedFigure()},t.prototype.getSecondTurn=function(){for(var e=this.getNormalizedFigure(),t=[],n=e.length,i=e[0].length,r=0;r<i;r++){t[r]=new Array(n).fill(!1);for(var o=0;o<n;o++)t[r][n-o-1]=e[o][r]}return t},t.prototype.getThirdTurn=function(){return this.getFirstTurn().reverse().map((function(e){return e.reverse()}))},t.prototype.getForthTurn=function(){return this.getSecondTurn().reverse().map((function(e){return e.reverse()}))},t}(function(){function e(){}return e.prototype.getTurn=function(e){switch(e){case u.One:return this.getFirstTurn();case u.Two:return this.getSecondTurn();case u.Three:return this.getThirdTurn();case u.Four:return this.getForthTurn()}},e}()),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["###".split("").map((function(e){return"#"===e})),"-#-".split("").map((function(e){return"#"===e}))]},t}(C),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["###".split("").map((function(e){return"#"===e})),"--#".split("").map((function(e){return"#"===e}))]},t}(C),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["###".split("").map((function(e){return"#"===e})),"#--".split("").map((function(e){return"#"===e}))]},t}(C),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["##".split("").map((function(e){return"#"===e})),"##".split("").map((function(e){return"#"===e}))]},t}(C),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["####".split("").map((function(e){return"#"===e}))]},t}(C),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["##-".split("").map((function(e){return"#"===e})),"-##".split("").map((function(e){return"#"===e}))]},t}(C),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),t.prototype.getFigure=function(){return["-##".split("").map((function(e){return"#"===e})),"##-".split("").map((function(e){return"#"===e}))]},t}(C),G=function(e,t){this.x=e,this.y=t},O=function(e,t,n,i){void 0===i&&(i=void 0),this.figure=e,this.position=t,this.turnState=n,this.color=i},k=function(e,t,n){this.fieldWidth=e,this.fieldHeight=t,this.figures=n},P=function(){this.figuresFallen=0,this.linesSquashed=0},L=function(){function e(e,t,n,i,r,o,a,s,u,l){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=setTimeout((function(){}))),void 0===a&&(a=1),void 0===s&&(s=0),void 0===u&&(u=0),void 0===l&&(l=new P),this.isInitialized=e,this.isGameOver=t,this.fallingFigures=n,this.matrix=i,this.nextTickTimeoutId=r,this.settings=o,this.level=a,this.score=s,this.combo=u,this.stats=l}return e.makeSimple=function(t,n){return void 0===t&&(t=10),void 0===n&&(n=20),new e(!1,!1,[],new Array(n).fill([]).map((function(e){return new Array(t).fill(!1)})),setTimeout((function(){})),new k(t,n,[new B,new M,new H,new S,new b,new E,new x]))},e}(),I=function(){function n(e,n,i){this.timingsHandler=e,this.eventBus=n,this.commandBus=i,this.gameData=L.makeSimple(),this.commandBus.addHandler(t.InitGame,this.initGameHandler.bind(this)),this.commandBus.addHandler(t.ResumeGame,this.resumeGameHandler.bind(this)),this.commandBus.addHandler(t.PauseGame,this.pauseGameHandler.bind(this)),this.commandBus.addHandler(t.GameOver,this.gameOverHandler.bind(this))}return n.prototype.initGameHandler=function(t){this.gameData=t.gameData,this.gameData.isInitialized=!0,this.eventBus.on(e.FallingTickProcessed,this.onFallTickProcessed.bind(this))},n.prototype.resumeGameHandler=function(e){this.gameData.isGameOver||(this.gameData.isInitialized||this.commandBus.run(new l(e.gameData)),this.fallTick())},n.prototype.pauseGameHandler=function(e){this.gameData=e.gameData,clearTimeout(this.gameData.nextTickTimeoutId),this.commandBus.run(new m(this.gameData))},n.prototype.gameOverHandler=function(){this.gameData.isInitialized=!1,this.gameData.isGameOver=!0,clearTimeout(this.gameData.nextTickTimeoutId),this.eventBus.fire(new i(this.gameData))},n.prototype.fallTick=function(){this.commandBus.run(new f(this.gameData))},n.prototype.onFallTickProcessed=function(e){clearTimeout(this.gameData.nextTickTimeoutId),this.gameData.isGameOver||(this.gameData.nextTickTimeoutId=setTimeout(this.fallTick.bind(this),this.timingsHandler.getDelayForNextTickMs(this.gameData)))},n}(),R=function(){function e(){}return e.canFigureBePlaced=function(e,t,n){return e.every((function(e,i){return e.every((function(e,r){var o=t.y+i,a=t.x+r;return!e||o<0&&a>=0&&a<=n[0].length-1||o in n&&a in n[o]&&!n[o][a]}))}))},e}(),_=function(e,t,n){this.filled=e,this.filledGameOver=t,this.empty=n},q=function(e,t,n,i,r){void 0===t&&(t=!0),void 0===n&&(n=new _("#007400","#780000","#fff")),void 0===i&&(i=new _("#007400","#780000",null)),void 0===r&&(r=new _("#b8e5e3",null,null)),this.containerElement=e,this.renderProjectionFigures=t,this.matrixCellColors=n,this.fallingFigureCellColors=i,this.projectionFigureCellColors=r},j=function(e,t){this.filled=e,this.empty=t},A=function(){function n(e,n,i){this.renderSettings=e,this.commandBus=n,this.eventBus=i,this.cellsHtmlElementsMap=[],n.addHandler(t.InitGame,this.initHandler.bind(this)),n.addHandler(t.Render,this.renderCommandHandler.bind(this))}return n.prototype.initHandler=function(t){this.table=n.createHtmlElement('<div style="float: left; display: table; border-collapse: collapse"></div>'),this.cellsHtmlElementsMap=[];for(var i=0;i<t.gameData.settings.fieldHeight;i++){var r=n.createHtmlElement('<div style="display: table-row"></div>');this.cellsHtmlElementsMap[i]=[];for(var o=0;o<t.gameData.settings.fieldWidth;o++){var a=n.createHtmlElement('<div style="display: table-cell; border: 1px solid #ccc; width: 20px; height: 20px"></div>');this.cellsHtmlElementsMap[i][o]=a,r.appendChild(a)}this.table.appendChild(r)}this.renderSettings.containerElement.innerHTML="",this.renderSettings.containerElement.appendChild(this.table),this.scoreDisplay=n.createHtmlElement('<div style="float: left; font-family: \'Helvetica Neue\', sans-serif; font-size: 20px; margin-left: 15px;">\n                Level: <span id="level"></span><br>\n                Score: <span id="score"></span><br>\n                Combo: <span id="combo"></span><br>\n                Figures fallen: <span id="figures_fallen"></span><br>\n                Lines squashed: <span id="lines_squashed"></span><br>\n            </div>'),this.renderSettings.containerElement.appendChild(this.scoreDisplay),this.renderSettings.containerElement.appendChild(n.createHtmlElement('<div style="clear: both"></div>')),this.eventBus.on(e.FallingTickProcessed,this.onFallTickProcessed.bind(this)),this.eventBus.on(e.GameOver,this.onGameOver.bind(this)),this.eventBus.on(e.FiguresMoved,this.onFiguresMoved.bind(this))},n.prototype.onFiguresMoved=function(e){this.renderState(e.gameData)},n.prototype.onFallTickProcessed=function(e){this.renderState(e.gameData)},n.prototype.onGameOver=function(e){this.renderState(e.gameData)},n.prototype.renderCommandHandler=function(e){this.renderState(e.gameData)},n.prototype.renderState=function(e){this.repaintMatrixCells(e.matrix,new G(0,0),e),this.renderSettings.renderProjectionFigures&&this.renderFallingFiguresProjection(e),this.renderFallingFigures(e),this.renderStats(e)},n.prototype.renderFallingFigures=function(e){var t=this;e.fallingFigures.forEach((function(n){t.repaintFallingFiguresCells(n,e)}))},n.prototype.renderFallingFiguresProjection=function(e){var t=this;e.fallingFigures.forEach((function(n){for(var i=n.figure.getTurn(n.turnState),r=n.position.x,o=n.position.y;R.canFigureBePlaced(i,new G(r,o+1),e.matrix);)o++;t.repaintProjectionFiguresCells(i,new G(r,o),e)}))},n.prototype.repaintMatrixCells=function(e,t,n){var i;i=n.isGameOver?new j(this.renderSettings.matrixCellColors.filledGameOver,this.renderSettings.matrixCellColors.empty):new j(this.renderSettings.matrixCellColors.filled,this.renderSettings.matrixCellColors.empty),this.repaintCells(e,t,i)},n.prototype.repaintFallingFiguresCells=function(e,t){var n;n=t.isGameOver?new j(this.renderSettings.fallingFigureCellColors.filledGameOver,this.renderSettings.fallingFigureCellColors.empty):new j(e.color||this.renderSettings.fallingFigureCellColors.filled,this.renderSettings.fallingFigureCellColors.empty),this.repaintCells(e.figure.getTurn(e.turnState),e.position,n)},n.prototype.repaintProjectionFiguresCells=function(e,t,n){var i;i=n.isGameOver?new j(this.renderSettings.projectionFigureCellColors.filledGameOver,this.renderSettings.projectionFigureCellColors.empty):new j(this.renderSettings.projectionFigureCellColors.filled,this.renderSettings.projectionFigureCellColors.empty),this.repaintCells(e,t,i)},n.prototype.repaintCells=function(e,t,n){var i=this;e.forEach((function(e,r){e.forEach((function(e,o){var a=r+t.y,s=o+t.x;if(a in i.cellsHtmlElementsMap&&s in i.cellsHtmlElementsMap[a]){var u=e?n.filled:n.empty;null!==u&&(i.cellsHtmlElementsMap[a][s].style.background=u)}}))}))},n.prototype.renderStats=function(e){var t=document.getElementById("level"),n=document.getElementById("score"),i=document.getElementById("combo"),r=document.getElementById("figures_fallen"),o=document.getElementById("lines_squashed");null!==t&&(t.innerHTML=e.level.toString()),null!==n&&(n.innerHTML=e.score.toString()),null!==i&&(i.innerHTML=e.combo.toString()),null!==r&&(r.innerHTML=e.stats.figuresFallen.toString()),null!==o&&(o.innerHTML=e.stats.linesSquashed.toString())},n.createHtmlElement=function(e){var t=document.createElement("div");if(t.innerHTML=e,t.children.length>1||null===t.firstElementChild)throw"The HTML must contain only one child";if(!(t.firstElementChild instanceof HTMLElement))throw"Something went wrong while trying to get HTMLElement child from div";return t.firstElementChild},n}(),N=function(){this.transferredFigures=[],this.isGameOver=!1},z=function(){function e(e,n){this.commandBus=e,this.eventBus=n,this.commandBus.addHandler(t.FiguresFallTick,this.processFiguresFallTickCommand.bind(this)),this.commandBus.addHandler(t.FiguresFallDown,this.processDropFiguresCommand.bind(this))}return e.prototype.processFiguresFallTickCommand=function(e){var t=this.fallFiguresForOneCell(e.gameData),i=this.squashLines(e.gameData.matrix);t.isGameOver&&this.commandBus.run(new d(e.gameData)),this.eventBus.fire(new n(e.gameData,t.transferredFigures,i,0))},e.prototype.processDropFiguresCommand=function(e){for(var t,i=new N,r=0;e.gameData.fallingFigures.length>0;){var o=this.fallFiguresForOneCell(e.gameData);(t=i.transferredFigures).push.apply(t,o.transferredFigures),i.isGameOver=i.isGameOver||o.isGameOver,r++}var a=this.squashLines(e.gameData.matrix);i.isGameOver&&this.commandBus.run(new d(e.gameData)),this.eventBus.fire(new n(e.gameData,i.transferredFigures,a,r-1))},e.prototype.fallFiguresForOneCell=function(e){var t=this,n=new N;return e.fallingFigures.forEach((function(i,r){var o;if(t.figureCanFall(e.matrix,i))i.position.y++;else{var a=t.transferFigureToMatrix(e.matrix,i);(o=n.transferredFigures).push.apply(o,e.fallingFigures.splice(r,1)),n.isGameOver=n.isGameOver||a}})),n},e.prototype.figureCanFall=function(e,t){return R.canFigureBePlaced(t.figure.getTurn(t.turnState),new G(t.position.x,t.position.y+1),e)},e.prototype.transferFigureToMatrix=function(e,t){var n=!1;return t.figure.getTurn(t.turnState).forEach((function(i,r){i.forEach((function(i,o){if(i){var a=t.position.x+o,s=t.position.y+r;s in e&&a in e[s]&&!e[s][a]?e[s][a]=!0:n=!0}}))})),n},e.prototype.squashLines=function(e){var t=[];return e.forEach((function(e,n){e.every((function(e){return e}))&&t.push(n)}),0),t.forEach((function(t){e.splice(t,1),e.unshift(new Array(e[0].length).fill(!1))})),t},e}(),W=function(){function e(){}return e.ToArray=function(e){return Object.keys(e).map((function(e){return Number.parseInt(e)})).filter((function(e){return!Number.isNaN(e)}))},e.GetRandom=function(t){var n=e.ToArray(t);return n[Math.floor(Math.random()*n.length)]},e}(),U=function(){function n(e,n){this.eventBus=e,this.commandBus=n,this.commandBus.addHandler(t.InitGame,this.initHandler.bind(this))}return n.prototype.initHandler=function(t){this.eventBus.on(e.FallingTickProcessed,this.processOnFallTick.bind(this))},n.prototype.processOnFallTick=function(e){this.addFigure(e.gameData)},n.prototype.addFigure=function(e){if(!(e.fallingFigures.length>0||e.isGameOver)){var t=Math.floor(Math.random()*e.settings.figures.length),n=e.settings.figures[t],i=W.GetRandom(u),r=n.getTurn(i),a=Math.max.apply(Math,r.map((function(e){return e.length}))),s=new G(Math.ceil(e.settings.fieldWidth/2-a/2)-1,-r.length),l=new O(n,s,i);e.fallingFigures.push(l),this.eventBus.fire(new o(e,[l]))}},n}(),Y=function(){function e(e,n){this.commandBus=e,this.eventBus=n,this.commandBus.addHandler(t.MoveLeft,this.processMoveLeftCommand.bind(this)),this.commandBus.addHandler(t.MoveRight,this.processMoveRightCommand.bind(this)),this.commandBus.addHandler(t.MoveDown,this.processMoveDownCommand.bind(this)),this.commandBus.addHandler(t.TurnClockwise,this.processTurnClockwiseCommand.bind(this))}return e.prototype.processMoveLeftCommand=function(e){e.gameData.fallingFigures.forEach((function(t){R.canFigureBePlaced(t.figure.getTurn(t.turnState),new G(t.position.x-1,t.position.y),e.gameData.matrix)&&t.position.x--})),this.eventBus.fire(new r(e.gameData))},e.prototype.processMoveRightCommand=function(e){e.gameData.fallingFigures.forEach((function(t){R.canFigureBePlaced(t.figure.getTurn(t.turnState),new G(t.position.x+1,t.position.y),e.gameData.matrix)&&t.position.x++})),this.eventBus.fire(new r(e.gameData))},e.prototype.processTurnClockwiseCommand=function(e){var t=W.ToArray(u);e.gameData.fallingFigures.forEach((function(n){var i=n.turnState+1;i in t||(i=t[0]),R.canFigureBePlaced(n.figure.getTurn(i),n.position,e.gameData.matrix)&&(n.turnState=i)})),this.eventBus.fire(new r(e.gameData))},e.prototype.processMoveDownCommand=function(e){this.commandBus.run(new f(e.gameData))},e}(),J=function(){function e(e){this.commandBus=e,this.commandBus.addHandler(t.InitGame,this.processInitGameCommand.bind(this))}return e.prototype.processInitGameCommand=function(e){var t=this;window.onkeydown=function(n){"ArrowLeft"===n.code?t.commandBus.run(new p(e.gameData)):"ArrowRight"===n.code?t.commandBus.run(new g(e.gameData)):"ArrowUp"===n.code?t.commandBus.run(new v(e.gameData)):"ArrowDown"===n.code||"ArrowDown"===n.code?t.commandBus.run(new y(e.gameData)):"Space"===n.code&&t.commandBus.run(new w(e.gameData))}},e}(),K=function(){function n(e,n,i,r){void 0===i&&(i=new Map([[1,100],[2,300],[3,500],[4,800]])),void 0===r&&(r=50),this.commandBus=e,this.eventBus=n,this.squashedRowsRewardThresholdsMap=i,this.rewardOnCombo=r,e.addHandler(t.InitGame,this.initGameHandler.bind(this))}return n.prototype.initGameHandler=function(t){this.eventBus.on(e.FallingTickProcessed,this.onFallingTickProcessed.bind(this))},n.prototype.onFallingTickProcessed=function(e){if(!(e.squashedLines.length<0)){var t=0;this.squashedRowsRewardThresholdsMap.forEach((function(n,i){i>e.squashedLines.length||(t=n)})),e.gameData.score+=t*e.gameData.level+this.rewardOnCombo*Math.max(0,e.gameData.combo-1)*e.gameData.level+2*e.droppedLines*e.gameData.level}},n}(),Q=function(){function n(e,n,i,r){this.eventBus=e,this.commandBus=n,this.levelIncreaseOnSquashedRowsNumber=i,this.maxLevels=r,this.squashedRowsCounter=0,this.commandBus.addHandler(t.InitGame,this.processInitGameCommand.bind(this))}return n.prototype.processInitGameCommand=function(t){this.eventBus.on(e.FallingTickProcessed,this.onFallTickProcessed.bind(this))},n.prototype.onFallTickProcessed=function(e){0!==e.squashedLines.length&&(this.squashedRowsCounter++,this.squashedRowsCounter>=this.levelIncreaseOnSquashedRowsNumber&&(this.squashedRowsCounter=0,e.gameData.level=Math.min(this.maxLevels,e.gameData.level+1)))},n}(),V=function(){function n(e,n){this.commandBus=e,this.eventBus=n,e.addHandler(t.InitGame,this.initGameHandler.bind(this))}return n.prototype.initGameHandler=function(t){this.eventBus.on(e.FallingTickProcessed,this.onFallTickProcessed.bind(this))},n.prototype.onFallTickProcessed=function(e){e.transferredToMatrixFigures.length<=0||(e.squashedLines.length>0?e.gameData.combo+=1:e.gameData.combo=0)},n}(),X=function(){function e(e){this.delayMs=e}return e.prototype.getDelayForNextTickMs=function(e){return this.delayMs},e}(),Z=function(){function n(e,n){this.commandBus=e,this.eventBus=n,e.addHandler(t.InitGame,this.initGameHandler.bind(this))}return n.prototype.initGameHandler=function(t){this.eventBus.on(e.FallingTickProcessed,this.onFallingTickProcessed.bind(this))},n.prototype.onFallingTickProcessed=function(e){e.gameData.stats.figuresFallen+=e.transferredToMatrixFigures.length,e.gameData.stats.linesSquashed+=e.squashedLines.length},n}(),$=function(){function e(e,t,n,i,r,o,s,u,l,c,h,f,d){void 0===e&&(e=new a),void 0===t&&(t=new F),void 0===n&&(n=new I(new X(2e3),e,t)),void 0===i&&(i=new Y(t,e)),void 0===r&&(r=new J(t)),void 0===o&&(o=new z(t,e)),void 0===s&&(s=new U(e,t)),void 0===u&&(u=new Q(e,t,8,15)),void 0===l&&(l=new V(t,e)),void 0===c&&(c=new K(t,e)),void 0===h&&(h=new Z(t,e)),void 0===f&&(f=new A(new q(document.body),t,e)),void 0===d&&(d=L.makeSimple()),this.eventBus=e,this.commandBus=t,this.gameController=n,this.movingHandler=i,this.movingController=r,this.fallingFiguresProcessor=o,this.figuresSpawner=s,this.levelCounter=u,this.comboCounter=l,this.scoreCounter=c,this.statsCounter=h,this.tableRenderer=f,this.gameData=d}return e.prototype.start=function(e){e=e||L.makeSimple(),this.commandBus.run(new l(e)),this.commandBus.run(new c(e))},e.prototype.resume=function(){this.commandBus.run(new c(this.gameData))},e.prototype.pause=function(){this.commandBus.run(new h(this.gameData))},e}();!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(D||(D={}));var ee=function(e,t){this.figuresTargetStates=e,this.pushInDirection=t},te=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return te(t,e),t}(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return te(t,e),t}(Error)),ie=function(){function e(e,t){this.commandBus=e,this.scoreCalculator=t}return e.prototype.resolve=function(e){var t=this;if(0!==e.fallingFigures.length){if(1!==e.fallingFigures.length)throw new ne;var n=e.fallingFigures[0],i=-1/0,r=new ee(new Map,void 0);this.processStates(e,(function(e,t,o){t>i&&(i=t,r=new ee(new Map([[n,e]]),o))}));var o="debugMode"in window&&window.debugMode,a=r.figuresTargetStates.get(n);if(o&&void 0!==a){var s=structuredClone(e);a.color="#f00",s.fallingFigures=[a],this.commandBus.run(new m(s)),this.processStates(e,(function(e,n,i){e.color="#00f",s.fallingFigures=[e],t.commandBus.run(new m(s))}))}return r}},e.prototype.processStates=function(e,t){for(var n=this,i=e.fallingFigures[0],r=W.ToArray(u);r[0]!==i.turnState;)r.unshift(r.pop());var o=new Map;r.forEach((function(e){o.set(e,i.figure.getTurn(e))})),o.forEach((function(r,o){for(var a=0;a<e.settings.fieldWidth-r[0].length+1;a++){var s=n.imagineFigureDrop(e.matrix,r,a),u=s[0],l=s[1],c=n.squashLines(l),h=n.scoreCalculator.calculateScore(e,l,c),f=new O(i.figure,new G(a,u),o);t(f,h,void 0)}})),o.forEach((function(r,o){for(var a=0;a<e.settings.fieldWidth-r[0].length+1;a++){var s=n.imagineFigurePushIn(e.matrix,r,a);if(void 0!==s){var u=s[0],l=s[1],c=s[2],h=n.squashLines(l),f=n.scoreCalculator.calculateScore(e,l,h),d=new O(i.figure,new G(a,u),o);t(d,f,c)}}}))},e.prototype.squashLines=function(e){var t=[];return e.forEach((function(e,n){e.every((function(e){return e}))&&t.push(n)}),0),t.forEach((function(t){e.splice(t,1),e.unshift(new Array(e[0].length).fill(!1))})),t.length},e.prototype.imagineFigureDrop=function(e,t,n){for(var i=structuredClone(e),r=-t.length;R.canFigureBePlaced(t,new G(n,r+1),e);)r++;return t.forEach((function(e,t){e.forEach((function(e,o){var a=r+t,s=n+o;a in i&&s in i[a]&&e&&(i[a][s]=!0)}))})),[r,i]},e.prototype.imagineFigurePushIn=function(e,t,n){},e}(),re=function(){function e(e,t){void 0===t&&(t=.8),this.initialDelayMs=e,this.base=t}return e.prototype.getDelayForNextTickMs=function(e){return Math.pow(this.base-.007*(e.level-1),e.level-1)*this.initialDelayMs},e}(),oe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oe(t,e),t}(Error),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oe(t,e),t}(ae),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oe(t,e),t}(ae),le=function(){function e(e,t){void 0===t&&(t=new re(100,.9)),this.commandBus=e,this.timingsHandler=t,this.nextMoveTimeoutId=setTimeout((function(){})),this.gameData=L.makeSimple()}return e.prototype.place=function(e,t){this.gameData=e,this.targetState=t,clearTimeout(this.nextMoveTimeoutId),this.nextMoveTimeoutId=setTimeout(this.processTick.bind(this),this.timingsHandler.getDelayForNextTickMs(this.gameData))},e.prototype.processTick=function(){if(0!==this.gameData.fallingFigures.length){if(1!==this.gameData.fallingFigures.length)throw new se;if(void 0!==this.targetState){var e=this.gameData.fallingFigures[0],t=this.targetState.figuresTargetStates.get(e);if(t){if(e.figure!==t.figure)throw new ue("Both of the original and the target falling figures must have the same figure in it.");if(e.turnState!=t.turnState)this.commandBus.run(new v(this.gameData));else{if(e.position.x==t.position.x)return void this.commandBus.run(new w(this.gameData));e.position.x>t.position.x?this.commandBus.run(new p(this.gameData)):this.commandBus.run(new g(this.gameData))}this.nextMoveTimeoutId=setTimeout(this.processTick.bind(this),this.timingsHandler.getDelayForNextTickMs(this.gameData))}}}},e}(),ce=function(){function e(){}return e.prototype.calculateScore=function(e,t,n){var i,r=e.settings.fieldHeight,o=e.settings.fieldWidth,a=5*n,s=this.calculateHoles(e.matrix),u=this.calculateHolesAndCoveredHeight(t,e.matrix),l=u[0],c=u[1],h=s-l;i=0===c||0===l?h>0?150*h:70*h:(h>0?150*h:70*h)-c*Math.pow(c,c/(r*l))*5;var f=this.calculateHeight(t),d=-f*Math.pow(f,f/r)*3,m=this.calculateFillableSpace(t,o),p=m[0],g=0;m[1]>5&&(g=-p*Math.pow(p,p/(r*o)));var v,y=this.calculateTunnelsExceptUncovered(t,e.matrix),w=y[0],F=y[1],T=i+a+d+(v=0===F?0:70*-F-w*Math.pow(w,w/(r*F))*7)+g;return isNaN(T)&&console.log(t,i,a,d,v,g),T},e.prototype.calculateHoles=function(e){var t=new Set,n=0;return e.forEach((function(e,i){e.forEach((function(e,i){e?t.add(i):t.has(i)&&n++}))})),n},e.prototype.calculateHolesAndCoveredHeight=function(e,t){var n=this.calculateTheHighestHoleCoveredY(t),i=n[0],r=n[1],o=new Map,a=0,s=0;return e.forEach((function(e,t){e.forEach((function(e,n){e&&!o.has(n)&&o.set(n,t);var u=o.get(n);void 0===u||e||(s++,void 0!==i&&void 0!==r&&(t<i?a+=t-u:u<r&&(a+=r-u)))}))})),[s,a]},e.prototype.calculateTheHighestHoleCoveredY=function(e){var t=void 0,n=void 0,i=new Map;return e.some((function(e,r){return e.some((function(e,o){e&&!i.has(o)&&i.set(o,r);var a=i.get(o);return void 0!==a&&!e&&(n=r,t=a,!0)}))})),[n,t]},e.prototype.calculateHeight=function(e){var t=-1;return e.every((function(e,n){return!!e.every((function(e){return!e}))&&(t=n,!0)})),e.length-t-1},e.prototype.calculateTunnelsExceptUncovered=function(e,t){var n=new Set;t.every((function(e){e.forEach((function(e,t){e&&n.add(t)}))}));var i=new Set,r=new Map,o=e[0].length;e.every((function(e,t){return e.forEach((function(e,t){e&&i.add(t)})),e.forEach((function(e,t){e||i.has(t)||n.has(t)||0!==t&&!i.has(t-1)||t!==o-1&&!i.has(t+1)||r.set(t,(r.get(t)||0)+1)})),i.size<o}));var a=0,s=0;return r.forEach((function(e){e>=3&&(a+=e,s++)})),[a,s]},e.prototype.calculateFillableSpace=function(e,t){var n=new Set,i=0,r=0;return e.every((function(e){return e.forEach((function(e,t){e&&n.add(t)})),e.forEach((function(e,t){!e&&n.size>0&&!n.has(t)&&i++})),n.size<t&&(n.size>0&&r++,!0)})),[i,r]},e}(),he=function(){function n(e,n,i,r){void 0===i&&(i=new ie(n,new ce)),void 0===r&&(r=new le(n)),this.eventBus=e,this.commandBus=n,this.fallingFigurePlacingResolver=i,this.fallingFiguresPlacer=r,this.commandBus.addHandler(t.InitGame,this.initGameHandler.bind(this))}return n.prototype.initGameHandler=function(t){this.eventBus.on(e.FiguresSpawned,this.onFiguresSpawned.bind(this))},n.prototype.onFiguresSpawned=function(e){var t=this.fallingFigurePlacingResolver.resolve(e.gameData);this.fallingFiguresPlacer.place(e.gameData,t)},n}();document.addEventListener("DOMContentLoaded",(function(){var e=new a,t=new F,n=new $(e,t);new he(e,t),n.start()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBQUEsRUFDQSxLQUFBQyxXQUFBQSxFQUNBLEtBQUE0UCw2QkFBQUEsRUFJQSxLQUFBQyxxQkFBQUEsRUFFUmpXLEtBQUtvRyxXQUFXM0UsV0FBVzFDLEVBQVlnQyxTQUFVZixLQUFLcUcsZ0JBQWdCQyxLQUFLdEcsTUFDL0UsQ0FVSixPQVJZLFlBQUFxRyxnQkFBUixTQUF3QkssR0FDcEIxRyxLQUFLbUcsU0FBU3ZHLEdBQUdkLEVBQVVXLGVBQWdCTyxLQUFLcVcsaUJBQWlCL1AsS0FBS3RHLE1BQzFFLEVBRVEsWUFBQXFXLGlCQUFSLFNBQXlCeFcsR0FDckIsSUFBTXlXLEVBQTZCdFcsS0FBS2dXLDZCQUE2QjFFLFFBQVF6UixFQUFNYixVQUNuRmdCLEtBQUtpVyxxQkFBcUI1QyxNQUFNeFQsRUFBTWIsU0FBVXNYLEVBQ3BELEVBQ0osRUFyQkEsR0NEQWpNLFNBQVNrTSxpQkFBaUIsb0JBQW9CLFdBQzFDLElBQU1wUSxFQUFXLElBQUk0SixFQUNmM0osRUFBYSxJQUFJNEosRUFDbkJ3RyxFQUFTLElBQUlDLEVBQWF0USxFQUFVQyxHQUMzQixJQUFJc1EsR0FBYXZRLEVBQVVDLEdBRXhDb1EsRUFBTzNGLE9BQ1gsRyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9UZXRyaXMvRXZlbnRCdXMvRXZlbnRCdXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9Db21tYW5kQnVzL0NvbW1hbmRCdXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9GaWd1cmVzLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXNTb2x2ZXIvQ29tbW9uLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXMvQ29tbW9uLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXMvR2FtZUNvbnRyb2xsZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9VdGlscy9GaWd1cmVQbGFjaW5nQ2hlY2tlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGV0cmlzL1JlbmRlcmVyL1RhYmxlUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9GYWxsaW5nRmlndXJlc1Byb2Nlc3Nvci9SZWd1bGFyRmFsbGluZ0ZpZ3VyZXNQcm9jZXNzb3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9VdGlscy9FbnVtSGVscGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXMvRmlndXJlc1NwYXduZXIvQWx3YXlzT25lRmlndXJlU3Bhd25lci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGV0cmlzL01vdmluZ0hhbmRsZXIvTW92aW5nSGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGV0cmlzL01vdmluZ0NvbnRyb2xsZXIvTW92aW5nQ29udHJvbGxlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGV0cmlzL1Njb3JlQ291bnRlci9GYWxsVGlja1Njb3JlQ291bnRlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGV0cmlzL0xldmVsQ291bnRlci9TcXVhc2hlZFJvd3NDb3VudGVyQmFzZWRMZXZlbENvdW50ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9Db21ib0NvdW50ZXIvQ29tYm9Db3VudGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXMvVGltaW5nc0hhbmRsZXIvQ29uc3RUaW1pbmdzSGFuZGxlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGV0cmlzL1N0YXRzQ291bnRlci9TdGF0c0NvdW50ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9UZXRyaXNGYWNhZGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpc1NvbHZlci9GaWd1cmVQbGFjaW5nUmVzb2x2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpcy9UaW1pbmdzSGFuZGxlci9MZXZlbEJhc2VkVGltaW5nc0hhbmRsZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RldHJpc1NvbHZlci9GaWd1cmVQbGFjaW5nUGVyZm9ybWVyLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXNTb2x2ZXIvU2NvcmVDYWxjdWxhdG9yLnRzIiwid2VicGFjazovLy8uL3NyYy9UZXRyaXNTb2x2ZXIvVGV0cmlzU29sdmVyLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0ZhbGxpbmdGaWd1cmUsIEdhbWVEYXRhfSBmcm9tIFwiLi4vQ29tbW9uXCI7XG5cbmV4cG9ydCBlbnVtIEV2ZW50VHlwZSB7XG4gICAgRmFsbGluZ1RpY2tQcm9jZXNzZWQsXG4gICAgR2FtZU92ZXIsXG4gICAgRmlndXJlc01vdmVkLFxuICAgIExldmVsVXAsXG4gICAgRmlndXJlc1NwYXduZWQsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXZlbnQge1xuICAgIGdhbWVEYXRhOiBHYW1lRGF0YTtcblxuICAgIGdldEV2ZW50VHlwZSgpOiBFdmVudFR5cGU7XG59XG5cbmV4cG9ydCBjbGFzcyBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50IGltcGxlbWVudHMgRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICAgICBwdWJsaWMgdHJhbnNmZXJyZWRUb01hdHJpeEZpZ3VyZXM6IEZhbGxpbmdGaWd1cmVbXSxcbiAgICAgICAgcHVibGljIHNxdWFzaGVkTGluZXM6IG51bWJlcltdLFxuICAgICAgICBwdWJsaWMgZHJvcHBlZExpbmVzOiBudW1iZXIsXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldEV2ZW50VHlwZSgpOiBFdmVudFR5cGUge1xuICAgICAgICByZXR1cm4gRXZlbnRUeXBlLkZhbGxpbmdUaWNrUHJvY2Vzc2VkO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEdhbWVPdmVyRXZlbnQgaW1wbGVtZW50cyBFdmVudCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBnYW1lRGF0YTogR2FtZURhdGEsXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldEV2ZW50VHlwZSgpOiBFdmVudFR5cGUge1xuICAgICAgICByZXR1cm4gRXZlbnRUeXBlLkdhbWVPdmVyO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEZpZ3VyZXNNb3ZlZEV2ZW50IGltcGxlbWVudHMgRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRFdmVudFR5cGUoKTogRXZlbnRUeXBlIHtcbiAgICAgICAgcmV0dXJuIEV2ZW50VHlwZS5GaWd1cmVzTW92ZWQ7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGV2ZWxVcEV2ZW50IGltcGxlbWVudHMgRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRFdmVudFR5cGUoKTogRXZlbnRUeXBlIHtcbiAgICAgICAgcmV0dXJuIEV2ZW50VHlwZS5MZXZlbFVwO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEZpZ3VyZXNTcGF3bmVkRXZlbnQgaW1wbGVtZW50cyBFdmVudCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBnYW1lRGF0YTogR2FtZURhdGEsXG4gICAgICAgIHB1YmxpYyBuZXdGaWd1cmVzOiBGYWxsaW5nRmlndXJlW10sXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldEV2ZW50VHlwZSgpOiBFdmVudFR5cGUge1xuICAgICAgICByZXR1cm4gRXZlbnRUeXBlLkZpZ3VyZXNTcGF3bmVkO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEV2ZW50QnVzIHtcbiAgICBwcml2YXRlIGhhbmRsZXJzOiBNYXA8RXZlbnRUeXBlLCAoKC4uLl86IGFueSkgPT4gdm9pZClbXT4gPSBuZXcgTWFwKCk7XG5cbiAgICBwdWJsaWMgb24oZXZlbnQ6IEV2ZW50VHlwZSwgaGFuZGxlcjogKC4uLl86IGFueSkgPT4gdm9pZCwgdW5pcXVlOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuICAgICAgICBsZXQgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChldmVudCkgfHwgW107XG4gICAgICAgIGlmICh1bmlxdWUgJiYgaGFuZGxlcnMuc29tZShib3VuZEhhbmRsZXIgPT4gYm91bmRIYW5kbGVyID09PSBoYW5kbGVyKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuc2V0KGV2ZW50LCBoYW5kbGVycyk7XG4gICAgfVxuXG4gICAgcHVibGljIG9mZihldmVudDogRXZlbnRUeXBlLCBoYW5kbGVyOiAoLi4uXzogYW55KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnMuZ2V0KGV2ZW50KSB8fCBbXTtcbiAgICAgICAgbGV0IGluZGV4ID0gaGFuZGxlcnMuaW5kZXhPZihoYW5kbGVyKTtcbiAgICAgICAgaWYgKGluZGV4ID4gMCkge1xuICAgICAgICAgICAgaGFuZGxlcnMuc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuc2V0KGV2ZW50LCBoYW5kbGVycyk7XG4gICAgfVxuXG4gICAgcHVibGljIGZpcmUoZXZlbnRQYXlsb2FkOiBFdmVudCk6IHZvaWQge1xuICAgICAgICBsZXQgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChldmVudFBheWxvYWQuZ2V0RXZlbnRUeXBlKCkpIHx8IFtdO1xuICAgICAgICBoYW5kbGVycy5mb3JFYWNoKGhhbmRsZXIgPT4ge2hhbmRsZXIoZXZlbnRQYXlsb2FkKX0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7R2FtZURhdGF9IGZyb20gXCIuLi9Db21tb25cIjtcblxuZXhwb3J0IGVudW0gQ29tbWFuZFR5cGUge1xuICAgIEluaXRHYW1lLFxuICAgIFJlc3VtZUdhbWUsXG4gICAgUGF1c2VHYW1lLFxuICAgIEZpZ3VyZXNGYWxsVGljayxcbiAgICBHYW1lT3ZlcixcbiAgICBSZW5kZXIsXG4gICAgTW92ZUxlZnQsXG4gICAgTW92ZVJpZ2h0LFxuICAgIFR1cm5DbG9ja3dpc2UsXG4gICAgTW92ZURvd24sXG4gICAgRmlndXJlc0ZhbGxEb3duLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbW1hbmQge1xuICAgIGdhbWVEYXRhOiBHYW1lRGF0YTtcblxuICAgIGdldENvbW1hbmRUeXBlKCk6IENvbW1hbmRUeXBlO1xufVxuXG5leHBvcnQgY2xhc3MgSW5pdEdhbWVDb21tYW5kIGltcGxlbWVudHMgQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBnYW1lRGF0YTogR2FtZURhdGEsXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldENvbW1hbmRUeXBlKCk6IENvbW1hbmRUeXBlIHtcbiAgICAgICAgcmV0dXJuIENvbW1hbmRUeXBlLkluaXRHYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc3VtZUdhbWVDb21tYW5kIGltcGxlbWVudHMgQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBnYW1lRGF0YTogR2FtZURhdGEsXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldENvbW1hbmRUeXBlKCk6IENvbW1hbmRUeXBlIHtcbiAgICAgICAgcmV0dXJuIENvbW1hbmRUeXBlLlJlc3VtZUdhbWU7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUGF1c2VHYW1lQ29tbWFuZCBpbXBsZW1lbnRzIENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRDb21tYW5kVHlwZSgpOiBDb21tYW5kVHlwZSB7XG4gICAgICAgIHJldHVybiBDb21tYW5kVHlwZS5QYXVzZUdhbWU7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRmlndXJlc0ZhbGxUaWNrQ29tbWFuZCBpbXBsZW1lbnRzIENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRDb21tYW5kVHlwZSgpOiBDb21tYW5kVHlwZSB7XG4gICAgICAgIHJldHVybiBDb21tYW5kVHlwZS5GaWd1cmVzRmFsbFRpY2s7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgR2FtZU92ZXJDb21tYW5kIGltcGxlbWVudHMgQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBnYW1lRGF0YTogR2FtZURhdGEsXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldENvbW1hbmRUeXBlKCk6IENvbW1hbmRUeXBlIHtcbiAgICAgICAgcmV0dXJuIENvbW1hbmRUeXBlLkdhbWVPdmVyO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlbmRlckNvbW1hbmQgaW1wbGVtZW50cyBDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGdhbWVEYXRhOiBHYW1lRGF0YSxcbiAgICApIHt9XG5cbiAgICBwdWJsaWMgZ2V0Q29tbWFuZFR5cGUoKTogQ29tbWFuZFR5cGUge1xuICAgICAgICByZXR1cm4gQ29tbWFuZFR5cGUuUmVuZGVyO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vdmVMZWZ0Q29tbWFuZCBpbXBsZW1lbnRzIENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRDb21tYW5kVHlwZSgpOiBDb21tYW5kVHlwZSB7XG4gICAgICAgIHJldHVybiBDb21tYW5kVHlwZS5Nb3ZlTGVmdDtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBNb3ZlUmlnaHRDb21tYW5kIGltcGxlbWVudHMgQ29tbWFuZCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBnYW1lRGF0YTogR2FtZURhdGEsXG4gICAgKSB7fVxuXG4gICAgcHVibGljIGdldENvbW1hbmRUeXBlKCk6IENvbW1hbmRUeXBlIHtcbiAgICAgICAgcmV0dXJuIENvbW1hbmRUeXBlLk1vdmVSaWdodDtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUdXJuQ2xvY2t3aXNlQ29tbWFuZCBpbXBsZW1lbnRzIENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRDb21tYW5kVHlwZSgpOiBDb21tYW5kVHlwZSB7XG4gICAgICAgIHJldHVybiBDb21tYW5kVHlwZS5UdXJuQ2xvY2t3aXNlO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vdmVEb3duQ29tbWFuZCBpbXBsZW1lbnRzIENvbW1hbmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZ2FtZURhdGE6IEdhbWVEYXRhLFxuICAgICkge31cblxuICAgIHB1YmxpYyBnZXRDb21tYW5kVHlwZSgpOiBDb21tYW5kVHlwZSB7XG4gICAgICAgIHJldHVybiBDb21tYW5kVHlwZS5Nb3ZlRG93bjtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEcm9wRmlndXJlc0NvbW1hbmQgaW1wbGVtZW50cyBDb21tYW5kIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGdhbWVEYXRhOiBHYW1lRGF0YSxcbiAgICApIHt9XG5cbiAgICBwdWJsaWMgZ2V0Q29tbWFuZFR5cGUoKTogQ29tbWFuZFR5cGUge1xuICAgICAgICByZXR1cm4gQ29tbWFuZFR5cGUuRmlndXJlc0ZhbGxEb3duO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbW1hbmRCdXMge1xuICAgIHByaXZhdGUgaGFuZGxlcnM6IE1hcDxDb21tYW5kVHlwZSwgKChwYXlsb2FkOiBDb21tYW5kKSA9PiB2b2lkKVtdPiA9IG5ldyBNYXAoKTtcblxuICAgIHB1YmxpYyBhZGRIYW5kbGVyKGV2ZW50OiBDb21tYW5kVHlwZSwgaGFuZGxlcjogKC4uLl86IGFueSkgPT4gdm9pZCwgdW5pcXVlOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuICAgICAgICBsZXQgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChldmVudCkgfHwgW107XG4gICAgICAgIGlmICh1bmlxdWUgJiYgaGFuZGxlcnMuc29tZShib3VuZEhhbmRsZXIgPT4gYm91bmRIYW5kbGVyID09PSBoYW5kbGVyKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuc2V0KGV2ZW50LCBoYW5kbGVycyk7XG4gICAgfVxuXG4gICAgcHVibGljIHJlbW92ZUhhbmRsZXIoZXZlbnQ6IENvbW1hbmRUeXBlLCBoYW5kbGVyOiAoLi4uXzogYW55KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnMuZ2V0KGV2ZW50KSB8fCBbXTtcbiAgICAgICAgbGV0IGluZGV4ID0gaGFuZGxlcnMuaW5kZXhPZihoYW5kbGVyKTtcbiAgICAgICAgaWYgKGluZGV4ID4gMCkge1xuICAgICAgICAgICAgaGFuZGxlcnMuc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuc2V0KGV2ZW50LCBoYW5kbGVycyk7XG4gICAgfVxuXG4gICAgcHVibGljIHJ1bihwYXlsb2FkOiBDb21tYW5kKTogdm9pZCB7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHRoaXMuaGFuZGxlcnMuZ2V0KHBheWxvYWQuZ2V0Q29tbWFuZFR5cGUoKSkgfHwgW107XG4gICAgICAgIGhhbmRsZXJzLmZvckVhY2goaGFuZGxlciA9PiB7aGFuZGxlcihwYXlsb2FkKX0pO1xuICAgIH1cbn1cbiIsImV4cG9ydCBlbnVtIEZpZ3VyZVR1cm5TdGF0ZSB7XG4gICAgT25lLFxuICAgIFR3byxcbiAgICBUaHJlZSxcbiAgICBGb3VyLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZ3VyZSB7XG4gICAgLyoqXG4gICAgICogQW55IGZpZ3VyZSBtdXN0IGJlIGFibGUgdG8gdHVybiA0IHRpbWVzIGluIDIgZGltZW5zaW9ucy5cbiAgICAgKiBBbGwgdHVybnMgYXJlIGNsb2Nrd2lzZS5cbiAgICAgKi9cbiAgICBnZXRUdXJuKGZpZ3VyZVR1cm5TdGF0ZTogRmlndXJlVHVyblN0YXRlKTogYm9vbGVhbltdW107XG4gICAgZ2V0Rmlyc3RUdXJuKCk6IGJvb2xlYW5bXVtdO1xuICAgIGdldFNlY29uZFR1cm4oKTogYm9vbGVhbltdW107XG4gICAgZ2V0VGhpcmRUdXJuKCk6IGJvb2xlYW5bXVtdO1xuICAgIGdldEZvcnRoVHVybigpOiBib29sZWFuW11bXTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0RmlndXJlIGltcGxlbWVudHMgRmlndXJle1xuICAgIHB1YmxpYyBhYnN0cmFjdCBnZXRGaXJzdFR1cm4oKTogYm9vbGVhbltdW107XG4gICAgcHVibGljIGFic3RyYWN0IGdldFNlY29uZFR1cm4oKTogYm9vbGVhbltdW107XG4gICAgcHVibGljIGFic3RyYWN0IGdldFRoaXJkVHVybigpOiBib29sZWFuW11bXTtcbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0Rm9ydGhUdXJuKCk6IGJvb2xlYW5bXVtdO1xuXG4gICAgZ2V0VHVybihmaWd1cmVUdXJuU3RhdGU6IEZpZ3VyZVR1cm5TdGF0ZSk6IGJvb2xlYW5bXVtdIHtcbiAgICAgICAgc3dpdGNoIChmaWd1cmVUdXJuU3RhdGUpIHtcbiAgICAgICAgICAgIGNhc2UgRmlndXJlVHVyblN0YXRlLk9uZTpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaXJzdFR1cm4oKTtcbiAgICAgICAgICAgIGNhc2UgRmlndXJlVHVyblN0YXRlLlR3bzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTZWNvbmRUdXJuKCk7XG4gICAgICAgICAgICBjYXNlIEZpZ3VyZVR1cm5TdGF0ZS5UaHJlZTpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUaGlyZFR1cm4oKTtcbiAgICAgICAgICAgIGNhc2UgRmlndXJlVHVyblN0YXRlLkZvdXI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rm9ydGhUdXJuKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyBnaXZlcyBhbiBlYXN5IHdheSB0byBkZWZpbmUgZmlndXJlcyBmb3IgdGV0cmlzLlxuICogSnVzdCBpbXBsZW1lbnQgdGhlIGdldEZpZ3VyZSBtZXRob2QgYW5kIHJldHVybiBmaWd1cmUgbGlrZSB0aGlzOlxuICogYGBgKHRzKVxuICogcHJvdGVjdGVkIGdldEZpZ3VyZSgpOiBib29sZWFuW11bXSB7XG4gKiAgICAgcmV0dXJuIFtcbiAqICAgICAgICAgW3RydWUsICB0cnVlLCB0cnVlXSxcbiAqICAgICAgICAgW2ZhbHNlLCB0cnVlLCBmYWxzZV0sXG4gKiAgICAgICAgIFt0cnVlLCAgdHJ1ZSwgdHJ1ZV0sXG4gKiAgICAgXTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIE9yIGRlZmluZSBpdCBsaWtlIHRoaXMgZm9yIG1vcmUgdmlzdWFsIHByZXNlbnRhdGlvbjpcbiAqIGBgYCh0cylcbiAqIHByb3RlY3RlZCBnZXRGaWd1cmUoKTogYm9vbGVhbltdW10ge1xuICogICAgIHJldHVybiBbXG4gKiAgICAgICAgIFwiIyMjXCIuc3BsaXQoXCJcIikubWFwKGl0ZW0gPT4gaXRlbSA9PT0gXCIjXCIpLFxuICogICAgICAgICBcIi0jLVwiLnNwbGl0KFwiXCIpLm1hcChpdGVtID0+IGl0ZW0gPT09IFwiI1wiKSxcbiAqICAgICAgICAgXCIjIyNcIi5zcGxpdChcIlwiKS5tYXAoaXRlbSA9PiBpdGVtID09PSBcIiNcIiksXG4gKiAgICAgXTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU2ltcGx5Um90YXRhYmxlRmlndXJlIGV4dGVuZHMgQWJzdHJhY3RGaWd1cmUge1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBnZXRGaWd1cmUoKTogYm9vbGVhbltdW107XG5cbiAgICBwcml2YXRlIGdldE5vcm1hbGl6ZWRGaWd1cmUoKTogYm9vbGVhbltdW10ge1xuICAgICAgICBsZXQgZmlndXJlID0gdGhpcy5nZXRGaWd1cmUoKTtcbiAgICAgICAgbGV0IHRoZUxvbmdlc3RSb3dTaXplID0gZmlndXJlLnJlZHVjZShcbiAgICAgICAgICAgIChwcmV2aW91cywgY3VycmVudCkgPT4gTWF0aC5tYXgocHJldmlvdXMsIGN1cnJlbnQubGVuZ3RoKSxcbiAgICAgICAgICAgIDBcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGZpZ3VyZS5tYXAocm93ID0+IHtcbiAgICAgICAgICAgIGxldCBvcmlnaW5hbExlbmd0aCA9IHJvdy5sZW5ndGg7XG4gICAgICAgICAgICByb3cubGVuZ3RoID0gdGhlTG9uZ2VzdFJvd1NpemU7XG4gICAgICAgICAgICByZXR1cm4gcm93LmZpbGwoZmFsc2UsIG9yaWdpbmFsTGVuZ3RoIC0gMSwgdGhlTG9uZ2VzdFJvd1NpemUgLSAxKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldEZpcnN0VHVybigpOiBib29sZWFuW11bXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE5vcm1hbGl6ZWRGaWd1cmUoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0U2Vjb25kVHVybigpOiBib29sZWFuW11bXSB7XG4gICAgICAgIGxldCBvcmlnaW5hbEZpZ3VyZSA9IHRoaXMuZ2V0Tm9ybWFsaXplZEZpZ3VyZSgpO1xuICAgICAgICBsZXQgdHVybmVkRmlndXJlOiBib29sZWFuW11bXSA9IFtdO1xuICAgICAgICBsZXQgb3JpZ2luYWxGaWd1cmVIZWlnaHQgPSBvcmlnaW5hbEZpZ3VyZS5sZW5ndGg7XG4gICAgICAgIGxldCBvcmlnaW5hbEZpZ3VyZVdpZHRoID0gb3JpZ2luYWxGaWd1cmVbMF0ubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IG9yaWdpbmFsRmlndXJlV2lkdGg7IHgrKykge1xuICAgICAgICAgICAgdHVybmVkRmlndXJlW3hdID0gbmV3IEFycmF5KG9yaWdpbmFsRmlndXJlSGVpZ2h0KS5maWxsKGZhbHNlKTtcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgb3JpZ2luYWxGaWd1cmVIZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgICAgIHR1cm5lZEZpZ3VyZVt4XVtvcmlnaW5hbEZpZ3VyZUhlaWdodCAtIHkgLSAxXSA9IG9yaWdpbmFsRmlndXJlW3ldW3hdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0dXJuZWRGaWd1cmU7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFRoaXJkVHVybigpOiBib29sZWFuW11bXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpcnN0VHVybigpLnJldmVyc2UoKS5tYXAocm93ID0+IHJvdy5yZXZlcnNlKCkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGb3J0aFR1cm4oKTogYm9vbGVhbltdW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTZWNvbmRUdXJuKCkucmV2ZXJzZSgpLm1hcChyb3cgPT4gcm93LnJldmVyc2UoKSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgVEZpZ3VyZSBleHRlbmRzIFNpbXBseVJvdGF0YWJsZUZpZ3VyZSB7XG4gICAgcHJvdGVjdGVkIGdldEZpZ3VyZSgpOiBib29sZWFuW11bXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIiMjI1wiLnNwbGl0KFwiXCIpLm1hcChpdGVtID0+IGl0ZW0gPT09IFwiI1wiKSxcbiAgICAgICAgICAgIFwiLSMtXCIuc3BsaXQoXCJcIikubWFwKGl0ZW0gPT4gaXRlbSA9PT0gXCIjXCIpLFxuICAgICAgICBdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJpZ2h0TEZpZ3VyZSBleHRlbmRzIFNpbXBseVJvdGF0YWJsZUZpZ3VyZSB7XG4gICAgcHJvdGVjdGVkIGdldEZpZ3VyZSgpOiBib29sZWFuW11bXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIiMjI1wiLnNwbGl0KFwiXCIpLm1hcChpdGVtID0+IGl0ZW0gPT09IFwiI1wiKSxcbiAgICAgICAgICAgIFwiLS0jXCIuc3BsaXQoXCJcIikubWFwKGl0ZW0gPT4gaXRlbSA9PT0gXCIjXCIpLFxuICAgICAgICBdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIExlZnRMRmlndXJlIGV4dGVuZHMgU2ltcGx5Um90YXRhYmxlRmlndXJlIHtcbiAgICBwcm90ZWN0ZWQgZ2V0RmlndXJlKCk6IGJvb2xlYW5bXVtdIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFwiIyMjXCIuc3BsaXQoXCJcIikubWFwKGl0ZW0gPT4gaXRlbSA9PT0gXCIjXCIpLFxuICAgICAgICAgICAgXCIjLS1cIi5zcGxpdChcIlwiKS5tYXAoaXRlbSA9PiBpdGVtID09PSBcIiNcIiksXG4gICAgICAgIF07XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3F1YXJlRmlndXJlIGV4dGVuZHMgU2ltcGx5Um90YXRhYmxlRmlndXJlIHtcbiAgICBwcm90ZWN0ZWQgZ2V0RmlndXJlKCk6IGJvb2xlYW5bXVtdIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFwiIyNcIi5zcGxpdChcIlwiKS5tYXAoaXRlbSA9PiBpdGVtID09PSBcIiNcIiksXG4gICAgICAgICAgICBcIiMjXCIuc3BsaXQoXCJcIikubWFwKGl0ZW0gPT4gaXRlbSA9PT0gXCIjXCIpLFxuICAgICAgICBdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0aWNrRmlndXJlIGV4dGVuZHMgU2ltcGx5Um90YXRhYmxlRmlndXJlIHtcbiAgICBwcm90ZWN0ZWQgZ2V0RmlndXJlKCk6IGJvb2xlYW5bXVtdIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFwiIyMjI1wiLnNwbGl0KFwiXCIpLm1hcChpdGVtID0+IGl0ZW0gPT09IFwiI1wiKSxcbiAgICAgICAgXTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBMWkZpZ3VyZSBleHRlbmRzIFNpbXBseVJvdGF0YWJsZUZpZ3VyZSB7XG4gICAgcHJvdGVjdGVkIGdldEZpZ3VyZSgpOiBib29sZWFuW11bXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBcIiMjLVwiLnNwbGl0KFwiXCIpLm1hcChpdGVtID0+IGl0ZW0gPT09IFwiI1wiKSxcbiAgICAgICAgICAgIFwiLSMjXCIuc3BsaXQoXCJcIikubWFwKGl0ZW0gPT4gaXRlbSA9PT0gXCIjXCIpLFxuICAgICAgICBdO1xuICAgIH1cbn1cblxuXG5leHBvcnQgY2xhc3MgUlpGaWd1cmUgZXh0ZW5kcyBTaW1wbHlSb3RhdGFibGVGaWd1cmUge1xuICAgIHByb3RlY3RlZCBnZXRGaWd1cmUoKTogYm9vbGVhbltdW10ge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgXCItIyNcIi5zcGxpdChcIlwiKS5tYXAoaXRlbSA9PiBpdGVtID09PSBcIiNcIiksXG4gICAgICAgICAgICBcIiMjLVwiLnNwbGl0KFwiXCIpLm1hcChpdGVtID0+IGl0ZW0gPT09IFwiI1wiKSxcbiAgICAgICAgXTtcbiAgICB9XG59XG4iLCJpbXBvcnQge0ZhbGxpbmdGaWd1cmV9IGZyb20gXCIuLi9UZXRyaXMvQ29tbW9uXCI7XG5cblxuZXhwb3J0IGVudW0gUHVzaEluRGlyZWN0aW9uIHtcbiAgICBMZWZ0LFxuICAgIFJpZ2h0LFxufVxuXG5leHBvcnQgY2xhc3MgRmlndXJlUGxhY2luZ1Jlc3VsdCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBmaWd1cmVzVGFyZ2V0U3RhdGVzOiBNYXA8RmFsbGluZ0ZpZ3VyZSwgRmFsbGluZ0ZpZ3VyZT4sXG4gICAgICAgIHB1YmxpYyBwdXNoSW5EaXJlY3Rpb246IFB1c2hJbkRpcmVjdGlvbnx1bmRlZmluZWQsXG4gICAgKSB7fVxufVxuIiwiaW1wb3J0IHtGaWd1cmUsIEZpZ3VyZVR1cm5TdGF0ZSwgTGVmdExGaWd1cmUsIExaRmlndXJlLCBSaWdodExGaWd1cmUsIFJaRmlndXJlLCBTcXVhcmVGaWd1cmUsIFN0aWNrRmlndXJlLCBURmlndXJlfSBmcm9tIFwiLi9GaWd1cmVzXCI7XG5cbi8qKlxuICogeCBmb3IgaG9yaXpvbnRhbCBwb3NpdGlvbmluZ1xuICogeSBmb3IgdmVydGljYWwgcG9zaXRpb25pbmdcbiAqL1xuZXhwb3J0IGNsYXNzIENvb3JkaW5hdGUge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgeDogbnVtYmVyLFxuICAgICAgICBwdWJsaWMgeTogbnVtYmVyLFxuICAgICkge31cbn1cblxuZXhwb3J0IGNsYXNzIEZhbGxpbmdGaWd1cmUge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZmlndXJlOiBGaWd1cmUsXG4gICAgICAgIHB1YmxpYyBwb3NpdGlvbjogQ29vcmRpbmF0ZSxcbiAgICAgICAgcHVibGljIHR1cm5TdGF0ZTogRmlndXJlVHVyblN0YXRlLFxuICAgICAgICBwdWJsaWMgY29sb3I6IHN0cmluZ3x1bmRlZmluZWQgPSB1bmRlZmluZWQsXG4gICAgKSB7fVxufVxuXG5leHBvcnQgY2xhc3MgR2FtZVNldHRpbmdzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGZpZWxkV2lkdGg6IG51bWJlcixcbiAgICAgICAgcHVibGljIGZpZWxkSGVpZ2h0OiBudW1iZXIsXG4gICAgICAgIHB1YmxpYyBmaWd1cmVzOiBGaWd1cmVbXSxcbiAgICApIHt9XG59XG5cbmV4cG9ydCBjbGFzcyBTdGF0cyB7XG4gICAgcHVibGljIGZpZ3VyZXNGYWxsZW4gPSAwO1xuICAgIHB1YmxpYyBsaW5lc1NxdWFzaGVkID0gMDtcbn1cblxuZXhwb3J0IGNsYXNzIEdhbWVEYXRhIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGlzSW5pdGlhbGl6ZWQ6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHVibGljIGlzR2FtZU92ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHVibGljIGZhbGxpbmdGaWd1cmVzOiBGYWxsaW5nRmlndXJlW10gPSBbXSxcbiAgICAgICAgcHVibGljIG1hdHJpeDogYm9vbGVhbltdW10gPSBbXSxcbiAgICAgICAgcHVibGljIG5leHRUaWNrVGltZW91dElkOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PiA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB9KSxcbiAgICAgICAgcHVibGljIHNldHRpbmdzOiBHYW1lU2V0dGluZ3MsXG4gICAgICAgIHB1YmxpYyBsZXZlbDogbnVtYmVyID0gMSxcbiAgICAgICAgcHVibGljIHNjb3JlOiBudW1iZXIgPSAwLFxuICAgICAgICBwdWJsaWMgY29tYm86IG51bWJlciA9IDAsXG4gICAgICAgIHB1YmxpYyBzdGF0czogU3RhdHMgPSBuZXcgU3RhdHMoKSxcbiAgICApIHt9XG5cbiAgICBzdGF0aWMgbWFrZVNpbXBsZSh3aWR0aDogbnVtYmVyID0gMTAsIGhlaWdodDogbnVtYmVyID0gMjApOiBHYW1lRGF0YSB7XG4gICAgICAgIHJldHVybiBuZXcgR2FtZURhdGEoXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgW10sXG4gICAgICAgICAgICBuZXcgQXJyYXkoaGVpZ2h0KS5maWxsKFtdKVxuICAgICAgICAgICAgICAgIC5tYXAoXyA9PiBuZXcgQXJyYXkod2lkdGgpLmZpbGwoZmFsc2UpKSxcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuZXcgR2FtZVNldHRpbmdzKFxuICAgICAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBURmlndXJlKCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBSaWdodExGaWd1cmUoKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IExlZnRMRmlndXJlKCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBTcXVhcmVGaWd1cmUoKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFN0aWNrRmlndXJlKCksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBMWkZpZ3VyZSgpLFxuICAgICAgICAgICAgICAgICAgICBuZXcgUlpGaWd1cmUoKSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgKTtcbiAgICB9XG59XG4iLCJpbXBvcnQge1RpbWluZ3NIYW5kbGVyfSBmcm9tIFwiLi9UaW1pbmdzSGFuZGxlci9UaW1pbmdzSGFuZGxlclwiO1xuaW1wb3J0IHtFdmVudEJ1cywgRXZlbnRUeXBlLCBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50LCBGaWd1cmVzTW92ZWRFdmVudCwgR2FtZU92ZXJFdmVudH0gZnJvbSBcIi4vRXZlbnRCdXMvRXZlbnRCdXNcIjtcbmltcG9ydCB7Q29tbWFuZEJ1cywgQ29tbWFuZFR5cGUsIEZpZ3VyZXNGYWxsVGlja0NvbW1hbmQsIEluaXRHYW1lQ29tbWFuZCwgUGF1c2VHYW1lQ29tbWFuZCwgUmVuZGVyQ29tbWFuZCwgUmVzdW1lR2FtZUNvbW1hbmR9IGZyb20gXCIuL0NvbW1hbmRCdXMvQ29tbWFuZEJ1c1wiO1xuaW1wb3J0IHtHYW1lRGF0YX0gZnJvbSBcIi4vQ29tbW9uXCI7XG5cbmV4cG9ydCBjbGFzcyBHYW1lQ29udHJvbGxlciB7XG4gICAgcHJpdmF0ZSBnYW1lRGF0YTogR2FtZURhdGEgPSBHYW1lRGF0YS5tYWtlU2ltcGxlKCk7XG5cbiAgICBjb25zdHJ1Y3RvciAoXG4gICAgICAgIHByaXZhdGUgdGltaW5nc0hhbmRsZXI6IFRpbWluZ3NIYW5kbGVyLFxuICAgICAgICBwcml2YXRlIGV2ZW50QnVzOiBFdmVudEJ1cyxcbiAgICAgICAgcHJpdmF0ZSBjb21tYW5kQnVzOiBDb21tYW5kQnVzLFxuICAgICkge1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5Jbml0R2FtZSwgdGhpcy5pbml0R2FtZUhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY29tbWFuZEJ1cy5hZGRIYW5kbGVyKENvbW1hbmRUeXBlLlJlc3VtZUdhbWUsIHRoaXMucmVzdW1lR2FtZUhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY29tbWFuZEJ1cy5hZGRIYW5kbGVyKENvbW1hbmRUeXBlLlBhdXNlR2FtZSwgdGhpcy5wYXVzZUdhbWVIYW5kbGVyLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5HYW1lT3ZlciwgdGhpcy5nYW1lT3ZlckhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0R2FtZUhhbmRsZXIoY29tbWFuZDogSW5pdEdhbWVDb21tYW5kKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZ2FtZURhdGEgPSBjb21tYW5kLmdhbWVEYXRhO1xuICAgICAgICB0aGlzLmdhbWVEYXRhLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKEV2ZW50VHlwZS5GYWxsaW5nVGlja1Byb2Nlc3NlZCwgdGhpcy5vbkZhbGxUaWNrUHJvY2Vzc2VkLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVzdW1lR2FtZUhhbmRsZXIoY29tbWFuZDogUmVzdW1lR2FtZUNvbW1hbmQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZ2FtZURhdGEuaXNHYW1lT3Zlcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5nYW1lRGF0YS5pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBJbml0R2FtZUNvbW1hbmQoY29tbWFuZC5nYW1lRGF0YSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmFsbFRpY2soKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHBhdXNlR2FtZUhhbmRsZXIoY29tbWFuZDogUGF1c2VHYW1lQ29tbWFuZCk6IHZvaWQge1xuICAgICAgICB0aGlzLmdhbWVEYXRhID0gY29tbWFuZC5nYW1lRGF0YTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZ2FtZURhdGEubmV4dFRpY2tUaW1lb3V0SWQpO1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBSZW5kZXJDb21tYW5kKHRoaXMuZ2FtZURhdGEpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdhbWVPdmVySGFuZGxlcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5nYW1lRGF0YS5pc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZ2FtZURhdGEuaXNHYW1lT3ZlciA9IHRydWU7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmdhbWVEYXRhLm5leHRUaWNrVGltZW91dElkKTtcbiAgICAgICAgdGhpcy5ldmVudEJ1cy5maXJlKG5ldyBHYW1lT3ZlckV2ZW50KHRoaXMuZ2FtZURhdGEpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZhbGxUaWNrKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBGaWd1cmVzRmFsbFRpY2tDb21tYW5kKHRoaXMuZ2FtZURhdGEpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRmFsbFRpY2tQcm9jZXNzZWQoZXZlbnQ6IEZhbGxUaWNrUHJvY2Vzc2VkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZ2FtZURhdGEubmV4dFRpY2tUaW1lb3V0SWQpO1xuICAgICAgICBpZiAoIXRoaXMuZ2FtZURhdGEuaXNHYW1lT3Zlcikge1xuICAgICAgICAgICAgdGhpcy5nYW1lRGF0YS5uZXh0VGlja1RpbWVvdXRJZCA9IHNldFRpbWVvdXQoXG4gICAgICAgICAgICAgICAgdGhpcy5mYWxsVGljay5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgIHRoaXMudGltaW5nc0hhbmRsZXIuZ2V0RGVsYXlGb3JOZXh0VGlja01zKHRoaXMuZ2FtZURhdGEpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHtDb29yZGluYXRlfSBmcm9tIFwiLi4vQ29tbW9uXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWd1cmVQbGFjaW5nQ2hlY2tlciB7XG4gICAgcHVibGljIHN0YXRpYyBjYW5GaWd1cmVCZVBsYWNlZCh0YXJnZXRGaWd1cmVNYXRyaXg6IGJvb2xlYW5bXVtdLCB0YXJnZXRQb3NpdGlvbjogQ29vcmRpbmF0ZSwgbWF0cml4OiBib29sZWFuW11bXSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGFyZ2V0RmlndXJlTWF0cml4LmV2ZXJ5KChyb3csIHkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiByb3cuZXZlcnkoKHZhbHVlLCB4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhbFkgPSB0YXJnZXRQb3NpdGlvbi55ICsgeTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWFsWCA9IHRhcmdldFBvc2l0aW9uLnggKyB4O1xuICAgICAgICAgICAgICAgIHJldHVybiAhdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgfHwgKFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFkgPCAwXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiByZWFsWCA+PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiByZWFsWCA8PSBtYXRyaXhbMF0ubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICApIHx8IChcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxZIGluIG1hdHJpeFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgcmVhbFggaW4gbWF0cml4W3JlYWxZXVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgIW1hdHJpeFtyZWFsWV1bcmVhbFhdXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtDb21tYW5kQnVzLCBDb21tYW5kVHlwZSwgSW5pdEdhbWVDb21tYW5kLCBSZW5kZXJDb21tYW5kfSBmcm9tIFwiLi4vQ29tbWFuZEJ1cy9Db21tYW5kQnVzXCI7XG5pbXBvcnQge0V2ZW50QnVzLCBFdmVudFR5cGUsIEZhbGxUaWNrUHJvY2Vzc2VkRXZlbnQsIEdhbWVPdmVyRXZlbnR9IGZyb20gXCIuLi9FdmVudEJ1cy9FdmVudEJ1c1wiO1xuaW1wb3J0IHtGaWd1cmVQbGFjaW5nQ2hlY2tlcn0gZnJvbSBcIi4uL1V0aWxzL0ZpZ3VyZVBsYWNpbmdDaGVja2VyXCI7XG5pbXBvcnQge0Nvb3JkaW5hdGUsIEZhbGxpbmdGaWd1cmUsIEdhbWVEYXRhfSBmcm9tIFwiLi4vQ29tbW9uXCI7XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVJlbmRlcmVyQ2VsbENvbG9yU2V0dGluZ3Mge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZmlsbGVkOiBzdHJpbmd8bnVsbCxcbiAgICAgICAgcHVibGljIGZpbGxlZEdhbWVPdmVyOiBzdHJpbmd8bnVsbCxcbiAgICAgICAgcHVibGljIGVtcHR5OiBzdHJpbmd8bnVsbCxcbiAgICApIHt9XG59XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVJlbmRlcmVyU2V0dGluZ3Mge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgY29udGFpbmVyRWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgICAgIHB1YmxpYyByZW5kZXJQcm9qZWN0aW9uRmlndXJlczogYm9vbGVhbiA9IHRydWUsXG4gICAgICAgIHB1YmxpYyBtYXRyaXhDZWxsQ29sb3JzOiBUYWJsZVJlbmRlcmVyQ2VsbENvbG9yU2V0dGluZ3MgPSBuZXcgVGFibGVSZW5kZXJlckNlbGxDb2xvclNldHRpbmdzKFxuICAgICAgICAgICAgJyMwMDc0MDAnLFxuICAgICAgICAgICAgJyM3ODAwMDAnLFxuICAgICAgICAgICAgJyNmZmYnLFxuICAgICAgICApLFxuICAgICAgICBwdWJsaWMgZmFsbGluZ0ZpZ3VyZUNlbGxDb2xvcnM6IFRhYmxlUmVuZGVyZXJDZWxsQ29sb3JTZXR0aW5ncyA9IG5ldyBUYWJsZVJlbmRlcmVyQ2VsbENvbG9yU2V0dGluZ3MoXG4gICAgICAgICAgICAnIzAwNzQwMCcsXG4gICAgICAgICAgICAnIzc4MDAwMCcsXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICApLFxuICAgICAgICBwdWJsaWMgcHJvamVjdGlvbkZpZ3VyZUNlbGxDb2xvcnM6IFRhYmxlUmVuZGVyZXJDZWxsQ29sb3JTZXR0aW5ncyA9IG5ldyBUYWJsZVJlbmRlcmVyQ2VsbENvbG9yU2V0dGluZ3MoXG4gICAgICAgICAgICAnI2I4ZTVlMycsXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgKSxcbiAgICApIHt9XG59XG5cbmNsYXNzIENlbGxDb2xvcnMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZmlsbGVkOiBzdHJpbmd8bnVsbCxcbiAgICAgICAgcHVibGljIGVtcHR5OiBzdHJpbmd8bnVsbCxcbiAgICApIHt9XG59XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVJlbmRlcmVyIHtcbiAgICBwcml2YXRlIGNlbGxzSHRtbEVsZW1lbnRzTWFwOiBIVE1MRWxlbWVudFtdW10gPSBbXTtcbiAgICBwcml2YXRlIHRhYmxlOiBIVE1MRWxlbWVudHx1bmRlZmluZWQ7XG4gICAgcHJpdmF0ZSBzY29yZURpc3BsYXk6IEhUTUxFbGVtZW50fHVuZGVmaW5lZDtcblxuICAgIGNvbnN0cnVjdG9yIChcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJTZXR0aW5nczogVGFibGVSZW5kZXJlclNldHRpbmdzLFxuICAgICAgICBwcml2YXRlIGNvbW1hbmRCdXM6IENvbW1hbmRCdXMsXG4gICAgICAgIHByaXZhdGUgZXZlbnRCdXM6IEV2ZW50QnVzLFxuICAgICkge1xuICAgICAgICBjb21tYW5kQnVzLmFkZEhhbmRsZXIoQ29tbWFuZFR5cGUuSW5pdEdhbWUsIHRoaXMuaW5pdEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIGNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5SZW5kZXIsIHRoaXMucmVuZGVyQ29tbWFuZEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0SGFuZGxlcihjb21tYW5kOiBJbml0R2FtZUNvbW1hbmQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50YWJsZSA9IFRhYmxlUmVuZGVyZXIuY3JlYXRlSHRtbEVsZW1lbnQoJzxkaXYgc3R5bGU9XCJmbG9hdDogbGVmdDsgZGlzcGxheTogdGFibGU7IGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2VcIj48L2Rpdj4nKTtcbiAgICAgICAgdGhpcy5jZWxsc0h0bWxFbGVtZW50c01hcCA9IFtdO1xuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IGNvbW1hbmQuZ2FtZURhdGEuc2V0dGluZ3MuZmllbGRIZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgbGV0IHJvdyA9IFRhYmxlUmVuZGVyZXIuY3JlYXRlSHRtbEVsZW1lbnQoJzxkaXYgc3R5bGU9XCJkaXNwbGF5OiB0YWJsZS1yb3dcIj48L2Rpdj4nKTtcbiAgICAgICAgICAgIHRoaXMuY2VsbHNIdG1sRWxlbWVudHNNYXBbeV0gPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgY29tbWFuZC5nYW1lRGF0YS5zZXR0aW5ncy5maWVsZFdpZHRoOyB4KyspIHtcbiAgICAgICAgICAgICAgICBsZXQgY2VsbCA9IFRhYmxlUmVuZGVyZXIuY3JlYXRlSHRtbEVsZW1lbnQoJzxkaXYgc3R5bGU9XCJkaXNwbGF5OiB0YWJsZS1jZWxsOyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyB3aWR0aDogMjBweDsgaGVpZ2h0OiAyMHB4XCI+PC9kaXY+Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jZWxsc0h0bWxFbGVtZW50c01hcFt5XVt4XSA9IGNlbGw7XG4gICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50YWJsZS5hcHBlbmRDaGlsZChyb3cpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyU2V0dGluZ3MuY29udGFpbmVyRWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgdGhpcy5yZW5kZXJTZXR0aW5ncy5jb250YWluZXJFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMudGFibGUpO1xuXG4gICAgICAgIHRoaXMuc2NvcmVEaXNwbGF5ID0gVGFibGVSZW5kZXJlci5jcmVhdGVIdG1sRWxlbWVudChcbiAgICAgICAgICAgIGA8ZGl2IHN0eWxlPVwiZmxvYXQ6IGxlZnQ7IGZvbnQtZmFtaWx5OiAnSGVsdmV0aWNhIE5ldWUnLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDIwcHg7IG1hcmdpbi1sZWZ0OiAxNXB4O1wiPlxuICAgICAgICAgICAgICAgIExldmVsOiA8c3BhbiBpZD1cImxldmVsXCI+PC9zcGFuPjxicj5cbiAgICAgICAgICAgICAgICBTY29yZTogPHNwYW4gaWQ9XCJzY29yZVwiPjwvc3Bhbj48YnI+XG4gICAgICAgICAgICAgICAgQ29tYm86IDxzcGFuIGlkPVwiY29tYm9cIj48L3NwYW4+PGJyPlxuICAgICAgICAgICAgICAgIEZpZ3VyZXMgZmFsbGVuOiA8c3BhbiBpZD1cImZpZ3VyZXNfZmFsbGVuXCI+PC9zcGFuPjxicj5cbiAgICAgICAgICAgICAgICBMaW5lcyBzcXVhc2hlZDogPHNwYW4gaWQ9XCJsaW5lc19zcXVhc2hlZFwiPjwvc3Bhbj48YnI+XG4gICAgICAgICAgICA8L2Rpdj5gKTtcbiAgICAgICAgdGhpcy5yZW5kZXJTZXR0aW5ncy5jb250YWluZXJFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuc2NvcmVEaXNwbGF5KTtcblxuICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLmNvbnRhaW5lckVsZW1lbnQuYXBwZW5kQ2hpbGQoVGFibGVSZW5kZXJlci5jcmVhdGVIdG1sRWxlbWVudCgnPGRpdiBzdHlsZT1cImNsZWFyOiBib3RoXCI+PC9kaXY+JykpO1xuXG4gICAgICAgIHRoaXMuZXZlbnRCdXMub24oRXZlbnRUeXBlLkZhbGxpbmdUaWNrUHJvY2Vzc2VkLCB0aGlzLm9uRmFsbFRpY2tQcm9jZXNzZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMub24oRXZlbnRUeXBlLkdhbWVPdmVyLCB0aGlzLm9uR2FtZU92ZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMub24oRXZlbnRUeXBlLkZpZ3VyZXNNb3ZlZCwgdGhpcy5vbkZpZ3VyZXNNb3ZlZC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRmlndXJlc01vdmVkKGNvbW1hbmQ6IEZhbGxUaWNrUHJvY2Vzc2VkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZW5kZXJTdGF0ZShjb21tYW5kLmdhbWVEYXRhKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRmFsbFRpY2tQcm9jZXNzZWQoY29tbWFuZDogRmFsbFRpY2tQcm9jZXNzZWRFdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlbmRlclN0YXRlKGNvbW1hbmQuZ2FtZURhdGEpO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25HYW1lT3Zlcihjb21tYW5kOiBHYW1lT3ZlckV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVuZGVyU3RhdGUoY29tbWFuZC5nYW1lRGF0YSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJDb21tYW5kSGFuZGxlcihjb21tYW5kOiBSZW5kZXJDb21tYW5kKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVuZGVyU3RhdGUoY29tbWFuZC5nYW1lRGF0YSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJTdGF0ZShnYW1lRGF0YTogR2FtZURhdGEpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBhaW50TWF0cml4Q2VsbHMoZ2FtZURhdGEubWF0cml4LCBuZXcgQ29vcmRpbmF0ZSgwLCAwKSwgZ2FtZURhdGEpO1xuICAgICAgICBpZiAodGhpcy5yZW5kZXJTZXR0aW5ncy5yZW5kZXJQcm9qZWN0aW9uRmlndXJlcykge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJGYWxsaW5nRmlndXJlc1Byb2plY3Rpb24oZ2FtZURhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyRmFsbGluZ0ZpZ3VyZXMoZ2FtZURhdGEpO1xuICAgICAgICB0aGlzLnJlbmRlclN0YXRzKGdhbWVEYXRhKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckZhbGxpbmdGaWd1cmVzKGdhbWVEYXRhOiBHYW1lRGF0YSk6IHZvaWQge1xuICAgICAgICBnYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5mb3JFYWNoKGZhbGxpbmdGaWd1cmUgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXBhaW50RmFsbGluZ0ZpZ3VyZXNDZWxscyhmYWxsaW5nRmlndXJlLCBnYW1lRGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyRmFsbGluZ0ZpZ3VyZXNQcm9qZWN0aW9uKGdhbWVEYXRhOiBHYW1lRGF0YSk6IHZvaWQge1xuICAgICAgICBnYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5mb3JFYWNoKGZhbGxpbmdGaWd1cmUgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmlndXJlTWF0cml4ID0gZmFsbGluZ0ZpZ3VyZS5maWd1cmUuZ2V0VHVybihmYWxsaW5nRmlndXJlLnR1cm5TdGF0ZSk7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0aW9uRmlndXJlWCA9IGZhbGxpbmdGaWd1cmUucG9zaXRpb24ueDtcbiAgICAgICAgICAgIGxldCBwcm9qZWN0aW9uRmlndXJlWSA9IGZhbGxpbmdGaWd1cmUucG9zaXRpb24ueTtcbiAgICAgICAgICAgIHdoaWxlKEZpZ3VyZVBsYWNpbmdDaGVja2VyLmNhbkZpZ3VyZUJlUGxhY2VkKGZpZ3VyZU1hdHJpeCwgbmV3IENvb3JkaW5hdGUocHJvamVjdGlvbkZpZ3VyZVgsIHByb2plY3Rpb25GaWd1cmVZICsgMSksIGdhbWVEYXRhLm1hdHJpeCkpIHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0aW9uRmlndXJlWSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBhaW50UHJvamVjdGlvbkZpZ3VyZXNDZWxscyhcbiAgICAgICAgICAgICAgICBmaWd1cmVNYXRyaXgsXG4gICAgICAgICAgICAgICAgbmV3IENvb3JkaW5hdGUocHJvamVjdGlvbkZpZ3VyZVgsIHByb2plY3Rpb25GaWd1cmVZKSxcbiAgICAgICAgICAgICAgICBnYW1lRGF0YVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXBhaW50TWF0cml4Q2VsbHMobWF0cml4OiBib29sZWFuW11bXSwgaW5kZW50OiBDb29yZGluYXRlLCBnYW1lRGF0YTogR2FtZURhdGEpOiB2b2lkIHtcbiAgICAgICAgbGV0IGNvbG9yczogQ2VsbENvbG9ycztcbiAgICAgICAgaWYgKGdhbWVEYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgICAgICAgIGNvbG9ycyA9IG5ldyBDZWxsQ29sb3JzKFxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU2V0dGluZ3MubWF0cml4Q2VsbENvbG9ycy5maWxsZWRHYW1lT3ZlcixcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLm1hdHJpeENlbGxDb2xvcnMuZW1wdHksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29sb3JzID0gbmV3IENlbGxDb2xvcnMoXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJTZXR0aW5ncy5tYXRyaXhDZWxsQ29sb3JzLmZpbGxlZCxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLm1hdHJpeENlbGxDb2xvcnMuZW1wdHksXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwYWludENlbGxzKG1hdHJpeCwgaW5kZW50LCBjb2xvcnMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVwYWludEZhbGxpbmdGaWd1cmVzQ2VsbHMoZmFsbGluZ0ZpZ3VyZTogRmFsbGluZ0ZpZ3VyZSwgZ2FtZURhdGE6IEdhbWVEYXRhKTogdm9pZCB7XG4gICAgICAgIGxldCBjb2xvcnM6IENlbGxDb2xvcnM7XG4gICAgICAgIGlmIChnYW1lRGF0YS5pc0dhbWVPdmVyKSB7XG4gICAgICAgICAgICBjb2xvcnMgPSBuZXcgQ2VsbENvbG9ycyhcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLmZhbGxpbmdGaWd1cmVDZWxsQ29sb3JzLmZpbGxlZEdhbWVPdmVyLFxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU2V0dGluZ3MuZmFsbGluZ0ZpZ3VyZUNlbGxDb2xvcnMuZW1wdHksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29sb3JzID0gbmV3IENlbGxDb2xvcnMoXG4gICAgICAgICAgICAgICAgZmFsbGluZ0ZpZ3VyZS5jb2xvciB8fCB0aGlzLnJlbmRlclNldHRpbmdzLmZhbGxpbmdGaWd1cmVDZWxsQ29sb3JzLmZpbGxlZCxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLmZhbGxpbmdGaWd1cmVDZWxsQ29sb3JzLmVtcHR5LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcGFpbnRDZWxscyhcbiAgICAgICAgICAgIGZhbGxpbmdGaWd1cmUuZmlndXJlLmdldFR1cm4oZmFsbGluZ0ZpZ3VyZS50dXJuU3RhdGUpLFxuICAgICAgICAgICAgZmFsbGluZ0ZpZ3VyZS5wb3NpdGlvbixcbiAgICAgICAgICAgIGNvbG9yc1xuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVwYWludFByb2plY3Rpb25GaWd1cmVzQ2VsbHMobWF0cml4OiBib29sZWFuW11bXSwgaW5kZW50OiBDb29yZGluYXRlLCBnYW1lRGF0YTogR2FtZURhdGEpOiB2b2lkIHtcbiAgICAgICAgbGV0IGNvbG9yczogQ2VsbENvbG9ycztcbiAgICAgICAgaWYgKGdhbWVEYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgICAgICAgIGNvbG9ycyA9IG5ldyBDZWxsQ29sb3JzKFxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU2V0dGluZ3MucHJvamVjdGlvbkZpZ3VyZUNlbGxDb2xvcnMuZmlsbGVkR2FtZU92ZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJTZXR0aW5ncy5wcm9qZWN0aW9uRmlndXJlQ2VsbENvbG9ycy5lbXB0eSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb2xvcnMgPSBuZXcgQ2VsbENvbG9ycyhcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLnByb2plY3Rpb25GaWd1cmVDZWxsQ29sb3JzLmZpbGxlZCxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclNldHRpbmdzLnByb2plY3Rpb25GaWd1cmVDZWxsQ29sb3JzLmVtcHR5LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcGFpbnRDZWxscyhtYXRyaXgsIGluZGVudCwgY29sb3JzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlcGFpbnRDZWxscyhtYXRyaXg6IGJvb2xlYW5bXVtdLCBpbmRlbnQ6IENvb3JkaW5hdGUsIGNlbGxDb2xvcnM6IENlbGxDb2xvcnMpOiB2b2lkIHtcbiAgICAgICAgbWF0cml4LmZvckVhY2goKHJvdywgeSkgPT4ge1xuICAgICAgICAgICAgcm93LmZvckVhY2goKHZhbHVlLCB4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhbFkgPSB5ICsgaW5kZW50Lnk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhbFggPSB4ICsgaW5kZW50Lng7XG4gICAgICAgICAgICAgICAgaWYgKHJlYWxZIGluIHRoaXMuY2VsbHNIdG1sRWxlbWVudHNNYXBcbiAgICAgICAgICAgICAgICAgICAgJiYgcmVhbFggaW4gdGhpcy5jZWxsc0h0bWxFbGVtZW50c01hcFtyZWFsWV1cbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sb3IgPSB2YWx1ZSA/IGNlbGxDb2xvcnMuZmlsbGVkIDogY2VsbENvbG9ycy5lbXB0eTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbG9yICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNlbGxzSHRtbEVsZW1lbnRzTWFwW3JlYWxZXVtyZWFsWF0uc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyU3RhdHMoZ2FtZURhdGE6IEdhbWVEYXRhKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGxldmVsU3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZXZlbCcpO1xuICAgICAgICBjb25zdCBzY29yZVNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NvcmUnKTtcbiAgICAgICAgY29uc3QgY29tYm9TcGFuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbWJvJyk7XG4gICAgICAgIGNvbnN0IGZpZ3VyZXNGYWxsZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlndXJlc19mYWxsZW4nKTtcbiAgICAgICAgY29uc3QgbGluZXNTcXVhc2hlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lc19zcXVhc2hlZCcpO1xuICAgICAgICBpZiAobGV2ZWxTcGFuICE9PSBudWxsKSB7XG4gICAgICAgICAgICBsZXZlbFNwYW4uaW5uZXJIVE1MID0gZ2FtZURhdGEubGV2ZWwudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NvcmVTcGFuICE9PSBudWxsKSB7XG4gICAgICAgICAgICBzY29yZVNwYW4uaW5uZXJIVE1MID0gZ2FtZURhdGEuc2NvcmUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29tYm9TcGFuICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb21ib1NwYW4uaW5uZXJIVE1MID0gZ2FtZURhdGEuY29tYm8udG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlndXJlc0ZhbGxlbiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZmlndXJlc0ZhbGxlbi5pbm5lckhUTUwgPSBnYW1lRGF0YS5zdGF0cy5maWd1cmVzRmFsbGVuLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpbmVzU3F1YXNoZWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGxpbmVzU3F1YXNoZWQuaW5uZXJIVE1MID0gZ2FtZURhdGEuc3RhdHMubGluZXNTcXVhc2hlZC50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSHRtbEVsZW1lbnQoaHRtbDogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xuICAgICAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICBpZiAoY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA+IDEgfHwgY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyAnVGhlIEhUTUwgbXVzdCBjb250YWluIG9ubHkgb25lIGNoaWxkJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIShjb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRocm93ICdTb21ldGhpbmcgd2VudCB3cm9uZyB3aGlsZSB0cnlpbmcgdG8gZ2V0IEhUTUxFbGVtZW50IGNoaWxkIGZyb20gZGl2JztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkO1xuICAgIH1cbn1cbiIsImltcG9ydCB7Q29vcmRpbmF0ZSwgRmFsbGluZ0ZpZ3VyZSwgR2FtZURhdGF9IGZyb20gXCIuLi9Db21tb25cIjtcbmltcG9ydCB7RHJvcEZpZ3VyZXNDb21tYW5kLCBDb21tYW5kQnVzLCBDb21tYW5kVHlwZSwgR2FtZU92ZXJDb21tYW5kLCBGaWd1cmVzRmFsbFRpY2tDb21tYW5kfSBmcm9tIFwiLi4vQ29tbWFuZEJ1cy9Db21tYW5kQnVzXCI7XG5pbXBvcnQge0V2ZW50QnVzLCBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50fSBmcm9tIFwiLi4vRXZlbnRCdXMvRXZlbnRCdXNcIjtcbmltcG9ydCB7RmlndXJlUGxhY2luZ0NoZWNrZXJ9IGZyb20gXCIuLi9VdGlscy9GaWd1cmVQbGFjaW5nQ2hlY2tlclwiO1xuXG5jbGFzcyBGYWxsaW5nUmVzdWx0IHtcbiAgICBwdWJsaWMgdHJhbnNmZXJyZWRGaWd1cmVzOiBGYWxsaW5nRmlndXJlW10gPSBbXTtcbiAgICBwdWJsaWMgaXNHYW1lT3ZlcjogYm9vbGVhbiA9IGZhbHNlO1xufVxuXG5leHBvcnQgY2xhc3MgUmVndWxhckZhbGxpbmdGaWd1cmVzUHJvY2Vzc29yIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBjb21tYW5kQnVzOiBDb21tYW5kQnVzLFxuICAgICAgICBwcml2YXRlIGV2ZW50QnVzOiBFdmVudEJ1cyxcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb21tYW5kQnVzLmFkZEhhbmRsZXIoQ29tbWFuZFR5cGUuRmlndXJlc0ZhbGxUaWNrLCB0aGlzLnByb2Nlc3NGaWd1cmVzRmFsbFRpY2tDb21tYW5kLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5GaWd1cmVzRmFsbERvd24sIHRoaXMucHJvY2Vzc0Ryb3BGaWd1cmVzQ29tbWFuZC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByb2Nlc3NGaWd1cmVzRmFsbFRpY2tDb21tYW5kKGNvbW1hbmQ6IEZpZ3VyZXNGYWxsVGlja0NvbW1hbmQpIHtcbiAgICAgICAgY29uc3QgZmFsbGluZ1Jlc3VsdCA9IHRoaXMuZmFsbEZpZ3VyZXNGb3JPbmVDZWxsKGNvbW1hbmQuZ2FtZURhdGEpO1xuICAgICAgICBsZXQgc3F1YXNoZWRMaW5lcyA9IHRoaXMuc3F1YXNoTGluZXMoY29tbWFuZC5nYW1lRGF0YS5tYXRyaXgpO1xuICAgICAgICBpZiAoZmFsbGluZ1Jlc3VsdC5pc0dhbWVPdmVyKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBHYW1lT3ZlckNvbW1hbmQoY29tbWFuZC5nYW1lRGF0YSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXZlbnRCdXMuZmlyZShuZXcgRmFsbFRpY2tQcm9jZXNzZWRFdmVudChcbiAgICAgICAgICAgIGNvbW1hbmQuZ2FtZURhdGEsXG4gICAgICAgICAgICBmYWxsaW5nUmVzdWx0LnRyYW5zZmVycmVkRmlndXJlcyxcbiAgICAgICAgICAgIHNxdWFzaGVkTGluZXMsXG4gICAgICAgICAgICAwXG4gICAgICAgICkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcHJvY2Vzc0Ryb3BGaWd1cmVzQ29tbWFuZChjb21tYW5kOiBEcm9wRmlndXJlc0NvbW1hbmQpOiB2b2lkIHtcbiAgICAgICAgbGV0IGZhbGxpbmdSZXN1bHQgPSBuZXcgRmFsbGluZ1Jlc3VsdCgpO1xuICAgICAgICBsZXQgZHJvcHBlZExpbmVzID0gMDtcbiAgICAgICAgd2hpbGUgKGNvbW1hbmQuZ2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3Qgb25lQ2VsbEZhbGxpbmdSZXN1bHQgPSB0aGlzLmZhbGxGaWd1cmVzRm9yT25lQ2VsbChjb21tYW5kLmdhbWVEYXRhKTtcbiAgICAgICAgICAgIGZhbGxpbmdSZXN1bHQudHJhbnNmZXJyZWRGaWd1cmVzLnB1c2goLi4ub25lQ2VsbEZhbGxpbmdSZXN1bHQudHJhbnNmZXJyZWRGaWd1cmVzKTtcbiAgICAgICAgICAgIGZhbGxpbmdSZXN1bHQuaXNHYW1lT3ZlciA9IGZhbGxpbmdSZXN1bHQuaXNHYW1lT3ZlciB8fCBvbmVDZWxsRmFsbGluZ1Jlc3VsdC5pc0dhbWVPdmVyO1xuICAgICAgICAgICAgZHJvcHBlZExpbmVzKys7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNxdWFzaGVkTGluZXMgPSB0aGlzLnNxdWFzaExpbmVzKGNvbW1hbmQuZ2FtZURhdGEubWF0cml4KTtcbiAgICAgICAgaWYgKGZhbGxpbmdSZXN1bHQuaXNHYW1lT3Zlcikge1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgR2FtZU92ZXJDb21tYW5kKGNvbW1hbmQuZ2FtZURhdGEpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV2ZW50QnVzLmZpcmUobmV3IEZhbGxUaWNrUHJvY2Vzc2VkRXZlbnQoXG4gICAgICAgICAgICBjb21tYW5kLmdhbWVEYXRhLFxuICAgICAgICAgICAgZmFsbGluZ1Jlc3VsdC50cmFuc2ZlcnJlZEZpZ3VyZXMsXG4gICAgICAgICAgICBzcXVhc2hlZExpbmVzLFxuICAgICAgICAgICAgZHJvcHBlZExpbmVzIC0gMSxcbiAgICAgICAgKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmYWxsRmlndXJlc0Zvck9uZUNlbGwoZ2FtZURhdGE6IEdhbWVEYXRhKTogRmFsbGluZ1Jlc3VsdCB7XG4gICAgICAgIGxldCBmYWxsaW5nUmVzdWx0ID0gbmV3IEZhbGxpbmdSZXN1bHQoKTtcbiAgICAgICAgZ2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMuZm9yRWFjaCgoZmFsbGluZ0ZpZ3VyZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZ3VyZUNhbkZhbGwoZ2FtZURhdGEubWF0cml4LCBmYWxsaW5nRmlndXJlKSkge1xuICAgICAgICAgICAgICAgIGZhbGxpbmdGaWd1cmUucG9zaXRpb24ueSsrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgZmlndXJlR2FtZU92ZXJSZXN1bHQgPSB0aGlzLnRyYW5zZmVyRmlndXJlVG9NYXRyaXgoXG4gICAgICAgICAgICAgICAgICAgIGdhbWVEYXRhLm1hdHJpeCxcbiAgICAgICAgICAgICAgICAgICAgZmFsbGluZ0ZpZ3VyZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZmFsbGluZ1Jlc3VsdC50cmFuc2ZlcnJlZEZpZ3VyZXMucHVzaCguLi5nYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5zcGxpY2UoaW5kZXgsIDEpKTtcbiAgICAgICAgICAgICAgICBmYWxsaW5nUmVzdWx0LmlzR2FtZU92ZXIgPSBmYWxsaW5nUmVzdWx0LmlzR2FtZU92ZXIgfHwgZmlndXJlR2FtZU92ZXJSZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmFsbGluZ1Jlc3VsdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZpZ3VyZUNhbkZhbGwobWF0cml4OiBib29sZWFuW11bXSwgZmFsbGluZ0ZpZ3VyZTogRmFsbGluZ0ZpZ3VyZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gRmlndXJlUGxhY2luZ0NoZWNrZXIuY2FuRmlndXJlQmVQbGFjZWQoXG4gICAgICAgICAgICBmYWxsaW5nRmlndXJlLmZpZ3VyZS5nZXRUdXJuKGZhbGxpbmdGaWd1cmUudHVyblN0YXRlKSxcbiAgICAgICAgICAgIG5ldyBDb29yZGluYXRlKGZhbGxpbmdGaWd1cmUucG9zaXRpb24ueCwgZmFsbGluZ0ZpZ3VyZS5wb3NpdGlvbi55ICsgMSksXG4gICAgICAgICAgICBtYXRyaXhcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRyYW5zZmVyRmlndXJlVG9NYXRyaXgobWF0cml4OiBib29sZWFuW11bXSwgZmFsbGluZ0ZpZ3VyZTogRmFsbGluZ0ZpZ3VyZSk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgaXNHYW1lT3ZlciA9IGZhbHNlO1xuICAgICAgICBmYWxsaW5nRmlndXJlLmZpZ3VyZS5nZXRUdXJuKGZhbGxpbmdGaWd1cmUudHVyblN0YXRlKVxuICAgICAgICAgICAgLmZvckVhY2goKHJvdywgZmlndXJlQ2VsbFkpID0+IHtcbiAgICAgICAgICAgICAgICByb3cuZm9yRWFjaCgoY2VsbFZhbHVlLCBmaWd1cmVDZWxsWCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNlbGxWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXRyaXhYID0gZmFsbGluZ0ZpZ3VyZS5wb3NpdGlvbi54ICsgZmlndXJlQ2VsbFg7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXRyaXhZID0gZmFsbGluZ0ZpZ3VyZS5wb3NpdGlvbi55ICsgZmlndXJlQ2VsbFk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRyaXhZIGluIG1hdHJpeFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgbWF0cml4WCBpbiBtYXRyaXhbbWF0cml4WV1cbiAgICAgICAgICAgICAgICAgICAgICAgICYmICFtYXRyaXhbbWF0cml4WV1bbWF0cml4WF1cbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXhbbWF0cml4WV1bbWF0cml4WF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNHYW1lT3ZlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaXNHYW1lT3ZlcjtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNxdWFzaExpbmVzKG1hdHJpeDogYm9vbGVhbltdW10pOiBudW1iZXJbXSB7XG4gICAgICAgIGxldCBsaW5lc1RvU3F1YXNoOiBudW1iZXJbXSA9IFtdO1xuICAgICAgICBtYXRyaXguZm9yRWFjaCgocm93LCB5KSA9PiB7XG4gICAgICAgICAgICBsZXQgY2FuQmVTcXVhc2hlZCA9IHJvdy5ldmVyeShjZWxsID0+IGNlbGwpO1xuICAgICAgICAgICAgaWYgKGNhbkJlU3F1YXNoZWQpIHtcbiAgICAgICAgICAgICAgICBsaW5lc1RvU3F1YXNoLnB1c2goeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDApO1xuICAgICAgICBsaW5lc1RvU3F1YXNoLmZvckVhY2goeSA9PiB7XG4gICAgICAgICAgICBtYXRyaXguc3BsaWNlKHksIDEpO1xuICAgICAgICAgICAgbWF0cml4LnVuc2hpZnQobmV3IEFycmF5KG1hdHJpeFswXS5sZW5ndGgpLmZpbGwoZmFsc2UpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsaW5lc1RvU3F1YXNoO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBFbnVtSGVscGVyIHtcbiAgICBwdWJsaWMgc3RhdGljIFRvQXJyYXkodmFsOiBhbnkpOiB0eXBlb2YgdmFsW10ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModmFsKVxuICAgICAgICAgICAgLm1hcChuID0+IE51bWJlci5wYXJzZUludChuKSlcbiAgICAgICAgICAgIC5maWx0ZXIobiA9PiAhTnVtYmVyLmlzTmFOKG4pKSBhcyB1bmtub3duIGFzIHR5cGVvZiB2YWxbXTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIEdldFJhbmRvbSh2YWw6IGFueSk6IHR5cGVvZiB2YWwge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBFbnVtSGVscGVyLlRvQXJyYXkodmFsKTtcbiAgICAgICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB2YWx1ZXMubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlc1tyYW5kb21JbmRleF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHtFdmVudEJ1cywgRXZlbnRUeXBlLCBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50LCBGaWd1cmVzU3Bhd25lZEV2ZW50fSBmcm9tIFwiLi4vRXZlbnRCdXMvRXZlbnRCdXNcIjtcbmltcG9ydCB7RmlndXJlVHVyblN0YXRlfSBmcm9tIFwiLi4vRmlndXJlc1wiO1xuaW1wb3J0IHtDb29yZGluYXRlLCBGYWxsaW5nRmlndXJlLCBHYW1lRGF0YX0gZnJvbSBcIi4uL0NvbW1vblwiO1xuaW1wb3J0IHtDb21tYW5kQnVzLCBDb21tYW5kVHlwZSwgSW5pdEdhbWVDb21tYW5kfSBmcm9tIFwiLi4vQ29tbWFuZEJ1cy9Db21tYW5kQnVzXCI7XG5pbXBvcnQge0VudW1IZWxwZXJ9IGZyb20gXCIuLi9VdGlscy9FbnVtSGVscGVyXCI7XG5cbmV4cG9ydCBjbGFzcyBBbHdheXNPbmVGaWd1cmVTcGF3bmVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBldmVudEJ1czogRXZlbnRCdXMsXG4gICAgICAgIHByaXZhdGUgY29tbWFuZEJ1czogQ29tbWFuZEJ1cyxcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb21tYW5kQnVzLmFkZEhhbmRsZXIoQ29tbWFuZFR5cGUuSW5pdEdhbWUsIHRoaXMuaW5pdEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0SGFuZGxlcihldmVudDogSW5pdEdhbWVDb21tYW5kKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMub24oXG4gICAgICAgICAgICBFdmVudFR5cGUuRmFsbGluZ1RpY2tQcm9jZXNzZWQsXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NPbkZhbGxUaWNrLmJpbmQodGhpcyksXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwcm9jZXNzT25GYWxsVGljayhldmVudDogRmFsbFRpY2tQcm9jZXNzZWRFdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEZpZ3VyZShldmVudC5nYW1lRGF0YSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRGaWd1cmUoZ2FtZURhdGE6IEdhbWVEYXRhKTogdm9pZCB7XG4gICAgICAgIGlmIChnYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5sZW5ndGggPiAwIHx8IGdhbWVEYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZpZ3VyZUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZ2FtZURhdGEuc2V0dGluZ3MuZmlndXJlcy5sZW5ndGgpO1xuICAgICAgICBjb25zdCBmaWd1cmUgPSBnYW1lRGF0YS5zZXR0aW5ncy5maWd1cmVzW2ZpZ3VyZUluZGV4XTtcbiAgICAgICAgY29uc3QgdHVyblN0YXRlID0gRW51bUhlbHBlci5HZXRSYW5kb20oRmlndXJlVHVyblN0YXRlKTtcbiAgICAgICAgY29uc3QgZmlndXJlTWF0cml4ID0gZmlndXJlLmdldFR1cm4odHVyblN0YXRlKTtcbiAgICAgICAgY29uc3QgZmlndXJlV2lkdGggPSBNYXRoLm1heCguLi5maWd1cmVNYXRyaXgubWFwKHJvdyA9PiByb3cubGVuZ3RoKSk7XG4gICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBuZXcgQ29vcmRpbmF0ZShcbiAgICAgICAgICAgIE1hdGguY2VpbChnYW1lRGF0YS5zZXR0aW5ncy5maWVsZFdpZHRoIC8gMiAtIGZpZ3VyZVdpZHRoIC8gMikgLSAxLFxuICAgICAgICAgICAgLWZpZ3VyZU1hdHJpeC5sZW5ndGgsXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGZhbGxpbmdGaWd1cmUgPSBuZXcgRmFsbGluZ0ZpZ3VyZShcbiAgICAgICAgICAgIGZpZ3VyZSxcbiAgICAgICAgICAgIGNvb3JkaW5hdGUsXG4gICAgICAgICAgICB0dXJuU3RhdGVcbiAgICAgICAgKTtcbiAgICAgICAgZ2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMucHVzaChmYWxsaW5nRmlndXJlKTtcbiAgICAgICAgdGhpcy5ldmVudEJ1cy5maXJlKG5ldyBGaWd1cmVzU3Bhd25lZEV2ZW50KGdhbWVEYXRhLCBbZmFsbGluZ0ZpZ3VyZV0pKTtcbiAgICB9XG59XG4iLCJpbXBvcnQge0NvbW1hbmRCdXMsIENvbW1hbmRUeXBlLCBNb3ZlTGVmdENvbW1hbmQsIE1vdmVSaWdodENvbW1hbmQsIFR1cm5DbG9ja3dpc2VDb21tYW5kLCBNb3ZlRG93bkNvbW1hbmQsIEZpZ3VyZXNGYWxsVGlja0NvbW1hbmR9IGZyb20gXCIuLi9Db21tYW5kQnVzL0NvbW1hbmRCdXNcIjtcbmltcG9ydCB7RmlndXJlVHVyblN0YXRlfSBmcm9tIFwiLi4vRmlndXJlc1wiO1xuaW1wb3J0IHtFdmVudEJ1cywgRmlndXJlc01vdmVkRXZlbnR9IGZyb20gXCIuLi9FdmVudEJ1cy9FdmVudEJ1c1wiO1xuaW1wb3J0IHtDb29yZGluYXRlLCBGYWxsaW5nRmlndXJlfSBmcm9tIFwiLi4vQ29tbW9uXCI7XG5pbXBvcnQge0ZpZ3VyZVBsYWNpbmdDaGVja2VyfSBmcm9tIFwiLi4vVXRpbHMvRmlndXJlUGxhY2luZ0NoZWNrZXJcIjtcbmltcG9ydCB7RW51bUhlbHBlcn0gZnJvbSBcIi4uL1V0aWxzL0VudW1IZWxwZXJcIjtcblxuZXhwb3J0IGNsYXNzIE1vdmluZ0hhbmRsZXIge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNvbW1hbmRCdXM6IENvbW1hbmRCdXMsXG4gICAgICAgIHByaXZhdGUgZXZlbnRCdXM6IEV2ZW50QnVzLFxuICAgICkge1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5Nb3ZlTGVmdCwgdGhpcy5wcm9jZXNzTW92ZUxlZnRDb21tYW5kLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5Nb3ZlUmlnaHQsIHRoaXMucHJvY2Vzc01vdmVSaWdodENvbW1hbmQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY29tbWFuZEJ1cy5hZGRIYW5kbGVyKENvbW1hbmRUeXBlLk1vdmVEb3duLCB0aGlzLnByb2Nlc3NNb3ZlRG93bkNvbW1hbmQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY29tbWFuZEJ1cy5hZGRIYW5kbGVyKENvbW1hbmRUeXBlLlR1cm5DbG9ja3dpc2UsIHRoaXMucHJvY2Vzc1R1cm5DbG9ja3dpc2VDb21tYW5kLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcHJvY2Vzc01vdmVMZWZ0Q29tbWFuZChjb21tYW5kOiBNb3ZlTGVmdENvbW1hbmQpOiB2b2lkIHtcbiAgICAgICAgY29tbWFuZC5nYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5mb3JFYWNoKGZpZ3VyZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYW5CZU1vdmVkTGVmdCA9IEZpZ3VyZVBsYWNpbmdDaGVja2VyLmNhbkZpZ3VyZUJlUGxhY2VkKFxuICAgICAgICAgICAgICAgIGZpZ3VyZS5maWd1cmUuZ2V0VHVybihmaWd1cmUudHVyblN0YXRlKSxcbiAgICAgICAgICAgICAgICBuZXcgQ29vcmRpbmF0ZShmaWd1cmUucG9zaXRpb24ueCAtIDEsIGZpZ3VyZS5wb3NpdGlvbi55KSxcbiAgICAgICAgICAgICAgICBjb21tYW5kLmdhbWVEYXRhLm1hdHJpeFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChjYW5CZU1vdmVkTGVmdCkge1xuICAgICAgICAgICAgICAgIGZpZ3VyZS5wb3NpdGlvbi54LS07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmV2ZW50QnVzLmZpcmUobmV3IEZpZ3VyZXNNb3ZlZEV2ZW50KGNvbW1hbmQuZ2FtZURhdGEpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByb2Nlc3NNb3ZlUmlnaHRDb21tYW5kKGNvbW1hbmQ6IE1vdmVSaWdodENvbW1hbmQpOiB2b2lkIHtcbiAgICAgICAgY29tbWFuZC5nYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5mb3JFYWNoKGZpZ3VyZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYW5CZU1vdmVkUmlnaHQgPSBGaWd1cmVQbGFjaW5nQ2hlY2tlci5jYW5GaWd1cmVCZVBsYWNlZChcbiAgICAgICAgICAgICAgICBmaWd1cmUuZmlndXJlLmdldFR1cm4oZmlndXJlLnR1cm5TdGF0ZSksXG4gICAgICAgICAgICAgICAgbmV3IENvb3JkaW5hdGUoZmlndXJlLnBvc2l0aW9uLnggKyAxLCBmaWd1cmUucG9zaXRpb24ueSksXG4gICAgICAgICAgICAgICAgY29tbWFuZC5nYW1lRGF0YS5tYXRyaXhcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoY2FuQmVNb3ZlZFJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgZmlndXJlLnBvc2l0aW9uLngrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMuZmlyZShuZXcgRmlndXJlc01vdmVkRXZlbnQoY29tbWFuZC5nYW1lRGF0YSkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcHJvY2Vzc1R1cm5DbG9ja3dpc2VDb21tYW5kKGNvbW1hbmQ6IFR1cm5DbG9ja3dpc2VDb21tYW5kKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGFsbFR1cm5TdGF0ZXMgPSBFbnVtSGVscGVyLlRvQXJyYXkoRmlndXJlVHVyblN0YXRlKTtcbiAgICAgICAgY29tbWFuZC5nYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5mb3JFYWNoKGZpZ3VyZSA9PiB7XG4gICAgICAgICAgICBsZXQgbmV4dFR1cm5TdGF0ZSA9IGZpZ3VyZS50dXJuU3RhdGUgKyAxO1xuICAgICAgICAgICAgaWYgKCEobmV4dFR1cm5TdGF0ZSBpbiBhbGxUdXJuU3RhdGVzKSkge1xuICAgICAgICAgICAgICAgIG5leHRUdXJuU3RhdGUgPSBhbGxUdXJuU3RhdGVzWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY2FuQmVUdXJuZWQgPSBGaWd1cmVQbGFjaW5nQ2hlY2tlci5jYW5GaWd1cmVCZVBsYWNlZChcbiAgICAgICAgICAgICAgICBmaWd1cmUuZmlndXJlLmdldFR1cm4obmV4dFR1cm5TdGF0ZSksXG4gICAgICAgICAgICAgICAgZmlndXJlLnBvc2l0aW9uLFxuICAgICAgICAgICAgICAgIGNvbW1hbmQuZ2FtZURhdGEubWF0cml4XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKGNhbkJlVHVybmVkKSB7XG4gICAgICAgICAgICAgICAgZmlndXJlLnR1cm5TdGF0ZSA9IG5leHRUdXJuU3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmV2ZW50QnVzLmZpcmUobmV3IEZpZ3VyZXNNb3ZlZEV2ZW50KGNvbW1hbmQuZ2FtZURhdGEpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByb2Nlc3NNb3ZlRG93bkNvbW1hbmQoY29tbWFuZDogTW92ZURvd25Db21tYW5kKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29tbWFuZEJ1cy5ydW4obmV3IEZpZ3VyZXNGYWxsVGlja0NvbW1hbmQoY29tbWFuZC5nYW1lRGF0YSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7Q29tbWFuZEJ1cywgQ29tbWFuZFR5cGUsIERyb3BGaWd1cmVzQ29tbWFuZCwgSW5pdEdhbWVDb21tYW5kLCBNb3ZlTGVmdENvbW1hbmQsIE1vdmVSaWdodENvbW1hbmQsIFR1cm5DbG9ja3dpc2VDb21tYW5kLCBNb3ZlRG93bkNvbW1hbmR9IGZyb20gXCIuLi9Db21tYW5kQnVzL0NvbW1hbmRCdXNcIjtcbmltcG9ydCB7R2FtZURhdGF9IGZyb20gXCIuLi9Db21tb25cIjtcblxuZXhwb3J0IGNsYXNzIE1vdmluZ0NvbnRyb2xsZXIge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNvbW1hbmRCdXM6IENvbW1hbmRCdXNcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb21tYW5kQnVzLmFkZEhhbmRsZXIoQ29tbWFuZFR5cGUuSW5pdEdhbWUsIHRoaXMucHJvY2Vzc0luaXRHYW1lQ29tbWFuZC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByb2Nlc3NJbml0R2FtZUNvbW1hbmQoY29tbWFuZDogSW5pdEdhbWVDb21tYW5kKSB7XG4gICAgICAgIHdpbmRvdy5vbmtleWRvd24gPSBldmVudCA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93TGVmdCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBNb3ZlTGVmdENvbW1hbmQoY29tbWFuZC5nYW1lRGF0YSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dSaWdodCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBNb3ZlUmlnaHRDb21tYW5kKGNvbW1hbmQuZ2FtZURhdGEpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93VXAnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgVHVybkNsb2Nrd2lzZUNvbW1hbmQoY29tbWFuZC5nYW1lRGF0YSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJykge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZEJ1cy5ydW4obmV3IE1vdmVEb3duQ29tbWFuZChjb21tYW5kLmdhbWVEYXRhKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgTW92ZURvd25Db21tYW5kKGNvbW1hbmQuZ2FtZURhdGEpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gJ1NwYWNlJykge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZEJ1cy5ydW4obmV3IERyb3BGaWd1cmVzQ29tbWFuZChjb21tYW5kLmdhbWVEYXRhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufVxuIiwiaW1wb3J0IHtFdmVudEJ1cywgRXZlbnRUeXBlLCBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50fSBmcm9tIFwiLi4vRXZlbnRCdXMvRXZlbnRCdXNcIjtcbmltcG9ydCB7Q29tbWFuZEJ1cywgQ29tbWFuZFR5cGUsIEluaXRHYW1lQ29tbWFuZH0gZnJvbSBcIi4uL0NvbW1hbmRCdXMvQ29tbWFuZEJ1c1wiO1xuXG5leHBvcnQgY2xhc3MgRmFsbFRpY2tTY29yZUNvdW50ZXIge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNvbW1hbmRCdXM6IENvbW1hbmRCdXMsXG4gICAgICAgIHByaXZhdGUgZXZlbnRCdXM6IEV2ZW50QnVzLFxuICAgICAgICBwcml2YXRlIHNxdWFzaGVkUm93c1Jld2FyZFRocmVzaG9sZHNNYXA6IE1hcDxudW1iZXIsIG51bWJlcj4gPSBuZXcgTWFwKFtcbiAgICAgICAgICAgIFsxLCAxMDBdLFxuICAgICAgICAgICAgWzIsIDMwMF0sXG4gICAgICAgICAgICBbMywgNTAwXSxcbiAgICAgICAgICAgIFs0LCA4MDBdLFxuICAgICAgICBdKSxcbiAgICAgICAgcHJpdmF0ZSByZXdhcmRPbkNvbWJvID0gNTAsXG4gICAgKSB7XG4gICAgICAgIGNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5Jbml0R2FtZSwgdGhpcy5pbml0R2FtZUhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0R2FtZUhhbmRsZXIoY29tbWFuZDogSW5pdEdhbWVDb21tYW5kKSB7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMub24oRXZlbnRUeXBlLkZhbGxpbmdUaWNrUHJvY2Vzc2VkLCB0aGlzLm9uRmFsbGluZ1RpY2tQcm9jZXNzZWQuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkZhbGxpbmdUaWNrUHJvY2Vzc2VkKGV2ZW50OiBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5zcXVhc2hlZExpbmVzLmxlbmd0aCA8IDApIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGxldCBwcmV2aW91c1RocmVzaG9sZFJld2FyZCA9IDA7XG4gICAgICAgIHRoaXMuc3F1YXNoZWRSb3dzUmV3YXJkVGhyZXNob2xkc01hcC5mb3JFYWNoKChyZXdhcmQsIHJvd3NTcXVhc2hlZFRocmVzaG9sZCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJvd3NTcXVhc2hlZFRocmVzaG9sZCA+IGV2ZW50LnNxdWFzaGVkTGluZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJldmlvdXNUaHJlc2hvbGRSZXdhcmQgPSByZXdhcmQ7XG4gICAgICAgIH0pO1xuICAgICAgICBldmVudC5nYW1lRGF0YS5zY29yZSArPVxuICAgICAgICAgICAgcHJldmlvdXNUaHJlc2hvbGRSZXdhcmQgKiBldmVudC5nYW1lRGF0YS5sZXZlbFxuICAgICAgICAgICAgKyB0aGlzLnJld2FyZE9uQ29tYm8gKiBNYXRoLm1heCgwLCBldmVudC5nYW1lRGF0YS5jb21ibyAtIDEpICogZXZlbnQuZ2FtZURhdGEubGV2ZWxcbiAgICAgICAgICAgICsgZXZlbnQuZHJvcHBlZExpbmVzICogMiAqIGV2ZW50LmdhbWVEYXRhLmxldmVsO1xuICAgIH1cbn1cbiIsImltcG9ydCB7RXZlbnRCdXMsIEV2ZW50VHlwZSwgRmFsbFRpY2tQcm9jZXNzZWRFdmVudH0gZnJvbSBcIi4uL0V2ZW50QnVzL0V2ZW50QnVzXCI7XG5pbXBvcnQge0NvbW1hbmRCdXMsIENvbW1hbmRUeXBlLCBJbml0R2FtZUNvbW1hbmR9IGZyb20gXCIuLi9Db21tYW5kQnVzL0NvbW1hbmRCdXNcIjtcblxuZXhwb3J0IGNsYXNzIFNxdWFzaGVkUm93c0NvdW50ZXJCYXNlZExldmVsQ291bnRlciB7XG4gICAgcHJpdmF0ZSBzcXVhc2hlZFJvd3NDb3VudGVyID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGV2ZW50QnVzOiBFdmVudEJ1cyxcbiAgICAgICAgcHJpdmF0ZSBjb21tYW5kQnVzOiBDb21tYW5kQnVzLFxuICAgICAgICBwcml2YXRlIGxldmVsSW5jcmVhc2VPblNxdWFzaGVkUm93c051bWJlcjogbnVtYmVyLFxuICAgICAgICBwcml2YXRlIG1heExldmVsczogbnVtYmVyLFxuICAgICkge1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMuYWRkSGFuZGxlcihDb21tYW5kVHlwZS5Jbml0R2FtZSwgdGhpcy5wcm9jZXNzSW5pdEdhbWVDb21tYW5kLmJpbmQodGhpcykpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwcm9jZXNzSW5pdEdhbWVDb21tYW5kKGNvbW1hbmQ6IEluaXRHYW1lQ29tbWFuZCkge1xuICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKEV2ZW50VHlwZS5GYWxsaW5nVGlja1Byb2Nlc3NlZCwgdGhpcy5vbkZhbGxUaWNrUHJvY2Vzc2VkLmJpbmQodGhpcykpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkZhbGxUaWNrUHJvY2Vzc2VkKGV2ZW50OiBGYWxsVGlja1Byb2Nlc3NlZEV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5zcXVhc2hlZExpbmVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3F1YXNoZWRSb3dzQ291bnRlcisrO1xuICAgICAgICBpZiAodGhpcy5zcXVhc2hlZFJvd3NDb3VudGVyID49IHRoaXMubGV2ZWxJbmNyZWFzZU9uU3F1YXNoZWRSb3dzTnVtYmVyKSB7XG4gICAgICAgICAgICB0aGlzLnNxdWFzaGVkUm93c0NvdW50ZXIgPSAwO1xuICAgICAgICAgICAgZXZlbnQuZ2FtZURhdGEubGV2ZWwgPSBNYXRoLm1pbih0aGlzLm1heExldmVscywgZXZlbnQuZ2FtZURhdGEubGV2ZWwgKyAxKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7RXZlbnRCdXMsIEV2ZW50VHlwZSwgRmFsbFRpY2tQcm9jZXNzZWRFdmVudH0gZnJvbSBcIi4uL0V2ZW50QnVzL0V2ZW50QnVzXCI7XG5pbXBvcnQge0NvbW1hbmRCdXMsIENvbW1hbmRUeXBlLCBJbml0R2FtZUNvbW1hbmR9IGZyb20gXCIuLi9Db21tYW5kQnVzL0NvbW1hbmRCdXNcIjtcblxuZXhwb3J0IGNsYXNzIENvbWJvQ291bnRlciB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBjb21tYW5kQnVzOiBDb21tYW5kQnVzLFxuICAgICAgICBwdWJsaWMgZXZlbnRCdXM6IEV2ZW50QnVzLFxuICAgICkge1xuICAgICAgICBjb21tYW5kQnVzLmFkZEhhbmRsZXIoQ29tbWFuZFR5cGUuSW5pdEdhbWUsIHRoaXMuaW5pdEdhbWVIYW5kbGVyLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdEdhbWVIYW5kbGVyKGNvbW1hbmQ6IEluaXRHYW1lQ29tbWFuZCkge1xuICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKEV2ZW50VHlwZS5GYWxsaW5nVGlja1Byb2Nlc3NlZCwgdGhpcy5vbkZhbGxUaWNrUHJvY2Vzc2VkLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25GYWxsVGlja1Byb2Nlc3NlZChldmVudDogRmFsbFRpY2tQcm9jZXNzZWRFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudHJhbnNmZXJyZWRUb01hdHJpeEZpZ3VyZXMubGVuZ3RoIDw9IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnQuc3F1YXNoZWRMaW5lcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBldmVudC5nYW1lRGF0YS5jb21ibyArPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXZlbnQuZ2FtZURhdGEuY29tYm8gPSAwO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHtUaW1pbmdzSGFuZGxlcn0gZnJvbSBcIi4vVGltaW5nc0hhbmRsZXJcIjtcbmltcG9ydCB7R2FtZURhdGF9IGZyb20gXCIuLi9Db21tb25cIjtcblxuZXhwb3J0IGNsYXNzIENvbnN0VGltaW5nc0hhbmRsZXIgaW1wbGVtZW50cyBUaW1pbmdzSGFuZGxlciB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBkZWxheU1zOiBudW1iZXIsXG4gICAgKSB7fVxuXG4gICAgZ2V0RGVsYXlGb3JOZXh0VGlja01zKGdhbWVEYXRhOiBHYW1lRGF0YSk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbGF5TXM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtDb21tYW5kQnVzLCBDb21tYW5kVHlwZSwgSW5pdEdhbWVDb21tYW5kfSBmcm9tIFwiLi4vQ29tbWFuZEJ1cy9Db21tYW5kQnVzXCI7XG5pbXBvcnQge0V2ZW50QnVzLCBFdmVudFR5cGUsIEZhbGxUaWNrUHJvY2Vzc2VkRXZlbnR9IGZyb20gXCIuLi9FdmVudEJ1cy9FdmVudEJ1c1wiO1xuXG5leHBvcnQgY2xhc3MgU3RhdHNDb3VudGVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBjb21tYW5kQnVzOiBDb21tYW5kQnVzLFxuICAgICAgICBwcml2YXRlIGV2ZW50QnVzOiBFdmVudEJ1cyxcbiAgICApIHtcbiAgICAgICAgY29tbWFuZEJ1cy5hZGRIYW5kbGVyKENvbW1hbmRUeXBlLkluaXRHYW1lLCB0aGlzLmluaXRHYW1lSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRHYW1lSGFuZGxlcihjb21tYW5kOiBJbml0R2FtZUNvbW1hbmQpIHtcbiAgICAgICAgdGhpcy5ldmVudEJ1cy5vbihFdmVudFR5cGUuRmFsbGluZ1RpY2tQcm9jZXNzZWQsIHRoaXMub25GYWxsaW5nVGlja1Byb2Nlc3NlZC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRmFsbGluZ1RpY2tQcm9jZXNzZWQoZXZlbnQ6IEZhbGxUaWNrUHJvY2Vzc2VkRXZlbnQpIHtcbiAgICAgICAgZXZlbnQuZ2FtZURhdGEuc3RhdHMuZmlndXJlc0ZhbGxlbiArPSBldmVudC50cmFuc2ZlcnJlZFRvTWF0cml4RmlndXJlcy5sZW5ndGg7XG4gICAgICAgIGV2ZW50LmdhbWVEYXRhLnN0YXRzLmxpbmVzU3F1YXNoZWQgKz0gZXZlbnQuc3F1YXNoZWRMaW5lcy5sZW5ndGg7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtHYW1lQ29udHJvbGxlcn0gZnJvbSAnLi9HYW1lQ29udHJvbGxlcidcbmltcG9ydCB7VGFibGVSZW5kZXJlciwgVGFibGVSZW5kZXJlclNldHRpbmdzfSBmcm9tICcuL1JlbmRlcmVyL1RhYmxlUmVuZGVyZXInXG5pbXBvcnQge1JlZ3VsYXJGYWxsaW5nRmlndXJlc1Byb2Nlc3Nvcn0gZnJvbSBcIi4vRmFsbGluZ0ZpZ3VyZXNQcm9jZXNzb3IvUmVndWxhckZhbGxpbmdGaWd1cmVzUHJvY2Vzc29yXCI7XG5pbXBvcnQge0Fsd2F5c09uZUZpZ3VyZVNwYXduZXJ9IGZyb20gXCIuL0ZpZ3VyZXNTcGF3bmVyL0Fsd2F5c09uZUZpZ3VyZVNwYXduZXJcIjtcbmltcG9ydCB7RXZlbnRCdXN9IGZyb20gXCIuL0V2ZW50QnVzL0V2ZW50QnVzXCI7XG5pbXBvcnQge0NvbW1hbmRCdXMsIEluaXRHYW1lQ29tbWFuZCwgUGF1c2VHYW1lQ29tbWFuZCwgUmVzdW1lR2FtZUNvbW1hbmR9IGZyb20gXCIuL0NvbW1hbmRCdXMvQ29tbWFuZEJ1c1wiO1xuaW1wb3J0IHtNb3ZpbmdIYW5kbGVyfSBmcm9tIFwiLi9Nb3ZpbmdIYW5kbGVyL01vdmluZ0hhbmRsZXJcIjtcbmltcG9ydCB7TW92aW5nQ29udHJvbGxlcn0gZnJvbSBcIi4vTW92aW5nQ29udHJvbGxlci9Nb3ZpbmdDb250cm9sbGVyXCI7XG5pbXBvcnQge0xldmVsQmFzZWRUaW1pbmdzSGFuZGxlcn0gZnJvbSBcIi4vVGltaW5nc0hhbmRsZXIvTGV2ZWxCYXNlZFRpbWluZ3NIYW5kbGVyXCI7XG5pbXBvcnQge0ZhbGxUaWNrU2NvcmVDb3VudGVyfSBmcm9tIFwiLi9TY29yZUNvdW50ZXIvRmFsbFRpY2tTY29yZUNvdW50ZXJcIjtcbmltcG9ydCB7U3F1YXNoZWRSb3dzQ291bnRlckJhc2VkTGV2ZWxDb3VudGVyfSBmcm9tIFwiLi9MZXZlbENvdW50ZXIvU3F1YXNoZWRSb3dzQ291bnRlckJhc2VkTGV2ZWxDb3VudGVyXCI7XG5pbXBvcnQge0dhbWVEYXRhfSBmcm9tIFwiLi9Db21tb25cIjtcbmltcG9ydCB7Q29tYm9Db3VudGVyfSBmcm9tIFwiLi9Db21ib0NvdW50ZXIvQ29tYm9Db3VudGVyXCI7XG5pbXBvcnQge0NvbnN0VGltaW5nc0hhbmRsZXJ9IGZyb20gXCIuL1RpbWluZ3NIYW5kbGVyL0NvbnN0VGltaW5nc0hhbmRsZXJcIjtcbmltcG9ydCB7U3RhdHNDb3VudGVyfSBmcm9tIFwiLi9TdGF0c0NvdW50ZXIvU3RhdHNDb3VudGVyXCI7XG5cbmV4cG9ydCBjbGFzcyBUZXRyaXNGYWNhZGUge1xuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBldmVudEJ1cyA9IG5ldyBFdmVudEJ1cygpLFxuICAgICAgICBwcml2YXRlIGNvbW1hbmRCdXMgPSBuZXcgQ29tbWFuZEJ1cygpLFxuICAgICAgICBwcml2YXRlIGdhbWVDb250cm9sbGVyID0gbmV3IEdhbWVDb250cm9sbGVyKFxuICAgICAgICAgICAgLy8gbmV3IExldmVsQmFzZWRUaW1pbmdzSGFuZGxlcigyMDAwKSxcbiAgICAgICAgICAgIG5ldyBDb25zdFRpbWluZ3NIYW5kbGVyKDIwMDApLFxuICAgICAgICAgICAgZXZlbnRCdXMsXG4gICAgICAgICAgICBjb21tYW5kQnVzLFxuICAgICAgICApLFxuICAgICAgICBwcml2YXRlIG1vdmluZ0hhbmRsZXIgPSBuZXcgTW92aW5nSGFuZGxlcihcbiAgICAgICAgICAgIGNvbW1hbmRCdXMsXG4gICAgICAgICAgICBldmVudEJ1cyxcbiAgICAgICAgKSxcbiAgICAgICAgcHJpdmF0ZSBtb3ZpbmdDb250cm9sbGVyID0gbmV3IE1vdmluZ0NvbnRyb2xsZXIoXG4gICAgICAgICAgICBjb21tYW5kQnVzLFxuICAgICAgICApLFxuICAgICAgICBwcml2YXRlIGZhbGxpbmdGaWd1cmVzUHJvY2Vzc29yID0gbmV3IFJlZ3VsYXJGYWxsaW5nRmlndXJlc1Byb2Nlc3NvcihcbiAgICAgICAgICAgIGNvbW1hbmRCdXMsXG4gICAgICAgICAgICBldmVudEJ1c1xuICAgICAgICApLFxuICAgICAgICBwcml2YXRlIGZpZ3VyZXNTcGF3bmVyID0gbmV3IEFsd2F5c09uZUZpZ3VyZVNwYXduZXIoXG4gICAgICAgICAgICBldmVudEJ1cyxcbiAgICAgICAgICAgIGNvbW1hbmRCdXMsXG4gICAgICAgICksXG4gICAgICAgIHByaXZhdGUgbGV2ZWxDb3VudGVyID0gbmV3IFNxdWFzaGVkUm93c0NvdW50ZXJCYXNlZExldmVsQ291bnRlcihcbiAgICAgICAgICAgIGV2ZW50QnVzLFxuICAgICAgICAgICAgY29tbWFuZEJ1cyxcbiAgICAgICAgICAgIDgsXG4gICAgICAgICAgICAxNSxcbiAgICAgICAgKSxcbiAgICAgICAgcHJpdmF0ZSBjb21ib0NvdW50ZXIgPSBuZXcgQ29tYm9Db3VudGVyKFxuICAgICAgICAgICAgY29tbWFuZEJ1cyxcbiAgICAgICAgICAgIGV2ZW50QnVzLFxuICAgICAgICApLFxuICAgICAgICBwcml2YXRlIHNjb3JlQ291bnRlciA9IG5ldyBGYWxsVGlja1Njb3JlQ291bnRlcihcbiAgICAgICAgICAgIGNvbW1hbmRCdXMsXG4gICAgICAgICAgICBldmVudEJ1cyxcbiAgICAgICAgKSxcbiAgICAgICAgcHJpdmF0ZSBzdGF0c0NvdW50ZXIgPSBuZXcgU3RhdHNDb3VudGVyKFxuICAgICAgICAgICAgY29tbWFuZEJ1cyxcbiAgICAgICAgICAgIGV2ZW50QnVzLFxuICAgICAgICApLFxuICAgICAgICBwcml2YXRlIHRhYmxlUmVuZGVyZXIgPSBuZXcgVGFibGVSZW5kZXJlcihcbiAgICAgICAgICAgIG5ldyBUYWJsZVJlbmRlcmVyU2V0dGluZ3MoXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBjb21tYW5kQnVzLFxuICAgICAgICAgICAgZXZlbnRCdXNcbiAgICAgICAgKSxcbiAgICAgICAgcHVibGljIGdhbWVEYXRhID0gR2FtZURhdGEubWFrZVNpbXBsZSgpLFxuICAgICkge31cblxuICAgIHB1YmxpYyBzdGFydChnYW1lRGF0YT86IEdhbWVEYXRhKSB7XG4gICAgICAgIGdhbWVEYXRhID0gZ2FtZURhdGEgfHwgR2FtZURhdGEubWFrZVNpbXBsZSgpO1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBJbml0R2FtZUNvbW1hbmQoZ2FtZURhdGEpKTtcbiAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgUmVzdW1lR2FtZUNvbW1hbmQoZ2FtZURhdGEpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVzdW1lKCkge1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBSZXN1bWVHYW1lQ29tbWFuZCh0aGlzLmdhbWVEYXRhKSk7XG4gICAgfVxuXG4gICAgcHVibGljIHBhdXNlKCkge1xuICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBQYXVzZUdhbWVDb21tYW5kKHRoaXMuZ2FtZURhdGEpKTtcbiAgICB9XG59XG4iLCJpbXBvcnQge0Nvb3JkaW5hdGUsIEZhbGxpbmdGaWd1cmUsIEdhbWVEYXRhfSBmcm9tIFwiLi4vVGV0cmlzL0NvbW1vblwiO1xuaW1wb3J0IHtFbnVtSGVscGVyfSBmcm9tIFwiLi4vVGV0cmlzL1V0aWxzL0VudW1IZWxwZXJcIjtcbmltcG9ydCB7RmlndXJlVHVyblN0YXRlfSBmcm9tIFwiLi4vVGV0cmlzL0ZpZ3VyZXNcIjtcbmltcG9ydCB7RmlndXJlUGxhY2luZ0NoZWNrZXJ9IGZyb20gXCIuLi9UZXRyaXMvVXRpbHMvRmlndXJlUGxhY2luZ0NoZWNrZXJcIjtcbmltcG9ydCB7Q29tbWFuZEJ1cywgUmVuZGVyQ29tbWFuZH0gZnJvbSBcIi4uL1RldHJpcy9Db21tYW5kQnVzL0NvbW1hbmRCdXNcIjtcbmltcG9ydCB7U2NvcmVDYWxjdWxhdG9yfSBmcm9tIFwiLi9TY29yZUNhbGN1bGF0b3JcIjtcbmltcG9ydCB7RmlndXJlUGxhY2luZ1Jlc3VsdCwgUHVzaEluRGlyZWN0aW9ufSBmcm9tIFwiLi9Db21tb25cIjtcblxuY2xhc3MgUGxhY2VSZXNvbHZpbmdFcnJvciBleHRlbmRzIEVycm9yIHtcbn1cblxuY2xhc3MgR2FtZVN0YXRlTm90U3VwcG9ydGVkRXJyb3IgZXh0ZW5kcyBQbGFjZVJlc29sdmluZ0Vycm9yIHtcbn1cblxuZXhwb3J0IGNsYXNzIEZpZ3VyZVBsYWNpbmdSZXNvbHZlciB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29tbWFuZEJ1czogQ29tbWFuZEJ1cyxcbiAgICAgICAgcHJpdmF0ZSBzY29yZUNhbGN1bGF0b3I6IFNjb3JlQ2FsY3VsYXRvcixcbiAgICApIHt9XG5cbiAgICBwdWJsaWMgcmVzb2x2ZShnYW1lRGF0YTogR2FtZURhdGEpOiBGaWd1cmVQbGFjaW5nUmVzdWx0fHVuZGVmaW5lZCB7XG4gICAgICAgIGlmIChnYW1lRGF0YS5mYWxsaW5nRmlndXJlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgR2FtZVN0YXRlTm90U3VwcG9ydGVkRXJyb3IoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBvcmlnaW5hbEZpZ3VyZSA9IGdhbWVEYXRhLmZhbGxpbmdGaWd1cmVzWzBdO1xuXG4gICAgICAgIGxldCBtYXhTY29yZSA9IC1JbmZpbml0eTtcbiAgICAgICAgbGV0IHRoZUJlc3RSZXN1bHQgPSBuZXcgRmlndXJlUGxhY2luZ1Jlc3VsdChuZXcgTWFwKCksIHVuZGVmaW5lZCk7XG5cbiAgICAgICAgdGhpcy5wcm9jZXNzU3RhdGVzKGdhbWVEYXRhLCAoZmFrZUZpZ3VyZTogRmFsbGluZ0ZpZ3VyZSwgc2NvcmU6IG51bWJlciwgcHVzaEluRGlyZWN0aW9uOiBQdXNoSW5EaXJlY3Rpb258dW5kZWZpbmVkKSA9PiB7XG4gICAgICAgICAgICBpZiAoc2NvcmUgPiBtYXhTY29yZSkge1xuICAgICAgICAgICAgICAgIG1heFNjb3JlID0gc2NvcmU7XG4gICAgICAgICAgICAgICAgdGhlQmVzdFJlc3VsdCA9IG5ldyBGaWd1cmVQbGFjaW5nUmVzdWx0KFxuICAgICAgICAgICAgICAgICAgICBuZXcgTWFwKFtbb3JpZ2luYWxGaWd1cmUsIGZha2VGaWd1cmVdXSksXG4gICAgICAgICAgICAgICAgICAgIHB1c2hJbkRpcmVjdGlvblxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgbGV0IGRlYnVnTW9kZSA9ICdkZWJ1Z01vZGUnIGluIHdpbmRvdyAmJiB3aW5kb3cuZGVidWdNb2RlO1xuICAgICAgICBsZXQgZmFrZUZpZ3VyZSA9IHRoZUJlc3RSZXN1bHQuZmlndXJlc1RhcmdldFN0YXRlcy5nZXQob3JpZ2luYWxGaWd1cmUpO1xuICAgICAgICBpZiAoZGVidWdNb2RlICYmIGZha2VGaWd1cmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbGV0IGZha2VHYW1lRGF0YSA9IHN0cnVjdHVyZWRDbG9uZShnYW1lRGF0YSk7XG4gICAgICAgICAgICBmYWtlRmlndXJlLmNvbG9yID0gJyNmMDAnO1xuICAgICAgICAgICAgZmFrZUdhbWVEYXRhLmZhbGxpbmdGaWd1cmVzID0gW2Zha2VGaWd1cmVdO1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgUmVuZGVyQ29tbWFuZChmYWtlR2FtZURhdGEpKTtcblxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzU3RhdGVzKGdhbWVEYXRhLCAoZmFrZUZpZ3VyZTogRmFsbGluZ0ZpZ3VyZSwgc2NvcmU6IG51bWJlciwgcHVzaEluRGlyZWN0aW9uOiBQdXNoSW5EaXJlY3Rpb258dW5kZWZpbmVkKSA9PiB7XG4gICAgICAgICAgICAgICAgZmFrZUZpZ3VyZS5jb2xvciA9ICcjMDBmJztcbiAgICAgICAgICAgICAgICBmYWtlR2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMgPSBbZmFrZUZpZ3VyZV07XG4gICAgICAgICAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgUmVuZGVyQ29tbWFuZChmYWtlR2FtZURhdGEpKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhlQmVzdFJlc3VsdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByb2Nlc3NTdGF0ZXMoZ2FtZURhdGE6IEdhbWVEYXRhLCBjYWxsYmFjazogKGZha2VGaWd1cmU6IEZhbGxpbmdGaWd1cmUsIHNjb3JlOiBudW1iZXIsIHB1c2hJbkRpcmVjdGlvbjogUHVzaEluRGlyZWN0aW9ufHVuZGVmaW5lZCkgPT4gdm9pZCkge1xuICAgICAgICBjb25zdCBvcmlnaW5hbEZpZ3VyZSA9IGdhbWVEYXRhLmZhbGxpbmdGaWd1cmVzWzBdO1xuXG4gICAgICAgIGxldCBlbnVtcyA9IEVudW1IZWxwZXIuVG9BcnJheShGaWd1cmVUdXJuU3RhdGUpO1xuICAgICAgICB3aGlsZSAoZW51bXNbMF0gIT09IG9yaWdpbmFsRmlndXJlLnR1cm5TdGF0ZSkge1xuICAgICAgICAgICAgZW51bXMudW5zaGlmdChlbnVtcy5wb3AoKSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG1hdHJpY2VzOiBNYXA8RmlndXJlVHVyblN0YXRlLCBib29sZWFuW11bXT4gPSBuZXcgTWFwKCk7XG4gICAgICAgIGVudW1zLmZvckVhY2godHVyblN0YXRlID0+IHtcbiAgICAgICAgICAgIG1hdHJpY2VzLnNldCh0dXJuU3RhdGUsIG9yaWdpbmFsRmlndXJlLmZpZ3VyZS5nZXRUdXJuKHR1cm5TdGF0ZSkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBtYXRyaWNlcy5mb3JFYWNoKChmaWd1cmVNYXRyaXgsIHR1cm5TdGF0ZSkgPT4ge1xuICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBnYW1lRGF0YS5zZXR0aW5ncy5maWVsZFdpZHRoIC0gZmlndXJlTWF0cml4WzBdLmxlbmd0aCArIDE7IHgrKykge1xuICAgICAgICAgICAgICAgIGxldCBbeSwgaW1hZ2luYWJsZU1hdHJpeF0gPSB0aGlzLmltYWdpbmVGaWd1cmVEcm9wKGdhbWVEYXRhLm1hdHJpeCwgZmlndXJlTWF0cml4LCB4KTtcbiAgICAgICAgICAgICAgICBsZXQgc3F1YXNoZWRMaW5lc0NvdW50ID0gdGhpcy5zcXVhc2hMaW5lcyhpbWFnaW5hYmxlTWF0cml4KTtcbiAgICAgICAgICAgICAgICBsZXQgc2NvcmUgPSB0aGlzLnNjb3JlQ2FsY3VsYXRvci5jYWxjdWxhdGVTY29yZShnYW1lRGF0YSwgaW1hZ2luYWJsZU1hdHJpeCwgc3F1YXNoZWRMaW5lc0NvdW50KTtcbiAgICAgICAgICAgICAgICBsZXQgZmFrZUZpZ3VyZSA9IG5ldyBGYWxsaW5nRmlndXJlKG9yaWdpbmFsRmlndXJlLmZpZ3VyZSwgbmV3IENvb3JkaW5hdGUoeCwgeSksIHR1cm5TdGF0ZSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZmFrZUZpZ3VyZSwgc2NvcmUsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1hdHJpY2VzLmZvckVhY2goKGZpZ3VyZU1hdHJpeCwgdHVyblN0YXRlKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IGdhbWVEYXRhLnNldHRpbmdzLmZpZWxkV2lkdGggLSBmaWd1cmVNYXRyaXhbMF0ubGVuZ3RoICsgMTsgeCsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGltYWdpbmFibGVSZXN1bHQgPSB0aGlzLmltYWdpbmVGaWd1cmVQdXNoSW4oZ2FtZURhdGEubWF0cml4LCBmaWd1cmVNYXRyaXgsIHgpO1xuICAgICAgICAgICAgICAgIGlmIChpbWFnaW5hYmxlUmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBbeSwgaW1hZ2luYWJsZU1hdHJpeCwgcHVzaEluRGlyZWN0aW9uXSA9IGltYWdpbmFibGVSZXN1bHQ7XG4gICAgICAgICAgICAgICAgbGV0IHNxdWFzaGVkTGluZXNDb3VudCA9IHRoaXMuc3F1YXNoTGluZXMoaW1hZ2luYWJsZU1hdHJpeCk7XG4gICAgICAgICAgICAgICAgbGV0IHNjb3JlID0gdGhpcy5zY29yZUNhbGN1bGF0b3IuY2FsY3VsYXRlU2NvcmUoZ2FtZURhdGEsIGltYWdpbmFibGVNYXRyaXgsIHNxdWFzaGVkTGluZXNDb3VudCk7XG4gICAgICAgICAgICAgICAgbGV0IGZha2VGaWd1cmUgPSBuZXcgRmFsbGluZ0ZpZ3VyZShvcmlnaW5hbEZpZ3VyZS5maWd1cmUsIG5ldyBDb29yZGluYXRlKHgsIHkpLCB0dXJuU3RhdGUpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGZha2VGaWd1cmUsIHNjb3JlLCBwdXNoSW5EaXJlY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNxdWFzaExpbmVzKG1hdHJpeDogYm9vbGVhbltdW10pOiBudW1iZXIge1xuICAgICAgICBsZXQgbGluZXNUb1NxdWFzaDogbnVtYmVyW10gPSBbXTtcbiAgICAgICAgbWF0cml4LmZvckVhY2goKHJvdywgeSkgPT4ge1xuICAgICAgICAgICAgbGV0IGNhbkJlU3F1YXNoZWQgPSByb3cuZXZlcnkoY2VsbCA9PiBjZWxsKTtcbiAgICAgICAgICAgIGlmIChjYW5CZVNxdWFzaGVkKSB7XG4gICAgICAgICAgICAgICAgbGluZXNUb1NxdWFzaC5wdXNoKHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAwKTtcbiAgICAgICAgbGluZXNUb1NxdWFzaC5mb3JFYWNoKHkgPT4ge1xuICAgICAgICAgICAgbWF0cml4LnNwbGljZSh5LCAxKTtcbiAgICAgICAgICAgIG1hdHJpeC51bnNoaWZ0KG5ldyBBcnJheShtYXRyaXhbMF0ubGVuZ3RoKS5maWxsKGZhbHNlKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbGluZXNUb1NxdWFzaC5sZW5ndGg7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbWFnaW5lRmlndXJlRHJvcChnYW1lTWF0cml4OiBib29sZWFuW11bXSwgZmlndXJlTWF0cml4OiBib29sZWFuW11bXSwgdGFyZ2V0WDogbnVtYmVyKTogW251bWJlciwgYm9vbGVhbltdW11dIHtcbiAgICAgICAgbGV0IGltYWdpbmFibGVNYXRyaXg6IGJvb2xlYW5bXVtdID0gc3RydWN0dXJlZENsb25lKGdhbWVNYXRyaXgpO1xuICAgICAgICBsZXQgdGFyZ2V0WSA9IC1maWd1cmVNYXRyaXgubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoRmlndXJlUGxhY2luZ0NoZWNrZXIuY2FuRmlndXJlQmVQbGFjZWQoZmlndXJlTWF0cml4LCBuZXcgQ29vcmRpbmF0ZSh0YXJnZXRYLCB0YXJnZXRZICsgMSksIGdhbWVNYXRyaXgpKSB7XG4gICAgICAgICAgICB0YXJnZXRZKys7XG4gICAgICAgIH1cbiAgICAgICAgZmlndXJlTWF0cml4LmZvckVhY2goKHJvdywgZmlndXJlWSkgPT4ge1xuICAgICAgICAgICAgcm93LmZvckVhY2goKHZhbCwgZmlndXJlWCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYWxZID0gdGFyZ2V0WSArIGZpZ3VyZVk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhbFggPSB0YXJnZXRYICsgZmlndXJlWDtcbiAgICAgICAgICAgICAgICBpZiAocmVhbFkgaW4gaW1hZ2luYWJsZU1hdHJpeFxuICAgICAgICAgICAgICAgICAgICAmJiByZWFsWCBpbiBpbWFnaW5hYmxlTWF0cml4W3JlYWxZXVxuICAgICAgICAgICAgICAgICAgICAmJiB2YWxcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2luYWJsZU1hdHJpeFtyZWFsWV1bcmVhbFhdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFt0YXJnZXRZLCBpbWFnaW5hYmxlTWF0cml4XTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGltYWdpbmVGaWd1cmVQdXNoSW4obWF0cml4OiBib29sZWFuW11bXSwgZmlndXJlTWF0cml4OiBib29sZWFuW11bXSwgeDogbnVtYmVyKTogW251bWJlciwgYm9vbGVhbltdW10sIFB1c2hJbkRpcmVjdGlvbl18dW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG59XG4iLCJpbXBvcnQge1RpbWluZ3NIYW5kbGVyfSBmcm9tIFwiLi9UaW1pbmdzSGFuZGxlclwiO1xuaW1wb3J0IHtHYW1lRGF0YX0gZnJvbSBcIi4uL0NvbW1vblwiO1xuXG5leHBvcnQgY2xhc3MgTGV2ZWxCYXNlZFRpbWluZ3NIYW5kbGVyIGltcGxlbWVudHMgVGltaW5nc0hhbmRsZXIge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGluaXRpYWxEZWxheU1zOiBudW1iZXIsXG4gICAgICAgIHByaXZhdGUgYmFzZTogbnVtYmVyID0gMC44LFxuICAgICkge31cblxuICAgIGdldERlbGF5Rm9yTmV4dFRpY2tNcyhnYW1lRGF0YTogR2FtZURhdGEpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gTWF0aC5wb3codGhpcy5iYXNlIC0gKGdhbWVEYXRhLmxldmVsIC0gMSkgKiAwLjAwNywgZ2FtZURhdGEubGV2ZWwgLSAxKSAqIHRoaXMuaW5pdGlhbERlbGF5TXM7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtHYW1lRGF0YX0gZnJvbSBcIi4uL1RldHJpcy9Db21tb25cIjtcbmltcG9ydCB7Q29tbWFuZEJ1cywgRHJvcEZpZ3VyZXNDb21tYW5kLCBNb3ZlTGVmdENvbW1hbmQsIE1vdmVSaWdodENvbW1hbmQsIFR1cm5DbG9ja3dpc2VDb21tYW5kfSBmcm9tIFwiLi4vVGV0cmlzL0NvbW1hbmRCdXMvQ29tbWFuZEJ1c1wiO1xuaW1wb3J0IHtMZXZlbEJhc2VkVGltaW5nc0hhbmRsZXJ9IGZyb20gXCIuLi9UZXRyaXMvVGltaW5nc0hhbmRsZXIvTGV2ZWxCYXNlZFRpbWluZ3NIYW5kbGVyXCI7XG5pbXBvcnQge0ZpZ3VyZVBsYWNpbmdSZXN1bHR9IGZyb20gXCIuL0NvbW1vblwiO1xuXG5jbGFzcyBQbGFjaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7fVxuY2xhc3MgR2FtZVN0YXRlTm90U3VwcG9ydGVkRXJyb3IgZXh0ZW5kcyBQbGFjaW5nRXJyb3Ige31cbmNsYXNzIEluY29uc2lzdGVudFRhcmdldFN0YXRlRXJyb3IgZXh0ZW5kcyBQbGFjaW5nRXJyb3Ige31cblxuZXhwb3J0IGNsYXNzIEZpZ3VyZVBsYWNpbmdQZXJmb3JtZXIge1xuICAgIHByaXZhdGUgbmV4dE1vdmVUaW1lb3V0SWQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+ID0gc2V0VGltZW91dCgoKSA9PiB7fSk7XG4gICAgcHJpdmF0ZSB0YXJnZXRTdGF0ZTogRmlndXJlUGxhY2luZ1Jlc3VsdHx1bmRlZmluZWQ7XG4gICAgcHJpdmF0ZSBnYW1lRGF0YTogR2FtZURhdGEgPSBHYW1lRGF0YS5tYWtlU2ltcGxlKCk7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBjb21tYW5kQnVzOiBDb21tYW5kQnVzLFxuICAgICAgICBwcml2YXRlIHRpbWluZ3NIYW5kbGVyID0gbmV3IExldmVsQmFzZWRUaW1pbmdzSGFuZGxlcigxMDAsIDAuOSksXG4gICAgKSB7fVxuXG4gICAgcHVibGljIHBsYWNlKGdhbWVEYXRhOiBHYW1lRGF0YSwgdGFyZ2V0U3RhdGU6IEZpZ3VyZVBsYWNpbmdSZXN1bHR8dW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuZ2FtZURhdGEgPSBnYW1lRGF0YTtcbiAgICAgICAgdGhpcy50YXJnZXRTdGF0ZSA9IHRhcmdldFN0YXRlO1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5uZXh0TW92ZVRpbWVvdXRJZCk7XG4gICAgICAgIHRoaXMubmV4dE1vdmVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KFxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzVGljay5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgdGhpcy50aW1pbmdzSGFuZGxlci5nZXREZWxheUZvck5leHRUaWNrTXModGhpcy5nYW1lRGF0YSksXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwcm9jZXNzVGljaygpIHtcbiAgICAgICAgaWYgKHRoaXMuZ2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZ2FtZURhdGEuZmFsbGluZ0ZpZ3VyZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgR2FtZVN0YXRlTm90U3VwcG9ydGVkRXJyb3IoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50YXJnZXRTdGF0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3JpZ2luYWxGaWd1cmUgPSB0aGlzLmdhbWVEYXRhLmZhbGxpbmdGaWd1cmVzWzBdO1xuICAgICAgICBjb25zdCB0YXJnZXRGaWd1cmUgPSB0aGlzLnRhcmdldFN0YXRlLmZpZ3VyZXNUYXJnZXRTdGF0ZXMuZ2V0KG9yaWdpbmFsRmlndXJlKTtcbiAgICAgICAgaWYgKCF0YXJnZXRGaWd1cmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcmlnaW5hbEZpZ3VyZS5maWd1cmUgIT09IHRhcmdldEZpZ3VyZS5maWd1cmUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbmNvbnNpc3RlbnRUYXJnZXRTdGF0ZUVycm9yKFwiQm90aCBvZiB0aGUgb3JpZ2luYWwgYW5kIHRoZSB0YXJnZXQgZmFsbGluZyBmaWd1cmVzIG11c3QgaGF2ZSB0aGUgc2FtZSBmaWd1cmUgaW4gaXQuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9yaWdpbmFsRmlndXJlLnR1cm5TdGF0ZSAhPSB0YXJnZXRGaWd1cmUudHVyblN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRCdXMucnVuKG5ldyBUdXJuQ2xvY2t3aXNlQ29tbWFuZCh0aGlzLmdhbWVEYXRhKSk7XG4gICAgICAgIH0gZWxzZSBpZiAob3JpZ2luYWxGaWd1cmUucG9zaXRpb24ueCAhPSB0YXJnZXRGaWd1cmUucG9zaXRpb24ueCkge1xuICAgICAgICAgICAgaWYgKG9yaWdpbmFsRmlndXJlLnBvc2l0aW9uLnggPiB0YXJnZXRGaWd1cmUucG9zaXRpb24ueCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZEJ1cy5ydW4obmV3IE1vdmVMZWZ0Q29tbWFuZCh0aGlzLmdhbWVEYXRhKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZEJ1cy5ydW4obmV3IE1vdmVSaWdodENvbW1hbmQodGhpcy5nYW1lRGF0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kQnVzLnJ1bihuZXcgRHJvcEZpZ3VyZXNDb21tYW5kKHRoaXMuZ2FtZURhdGEpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoaXMucHJvY2Vzc1RpY2soKTtcbiAgICAgICAgdGhpcy5uZXh0TW92ZVRpbWVvdXRJZCA9IHNldFRpbWVvdXQoXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NUaWNrLmJpbmQodGhpcyksXG4gICAgICAgICAgICAvLyAwLFxuICAgICAgICAgICAgdGhpcy50aW1pbmdzSGFuZGxlci5nZXREZWxheUZvck5leHRUaWNrTXModGhpcy5nYW1lRGF0YSksXG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtHYW1lRGF0YX0gZnJvbSBcIi4uL1RldHJpcy9Db21tb25cIjtcblxuZXhwb3J0IGNsYXNzIFNjb3JlQ2FsY3VsYXRvciB7XG4gICAgcHVibGljIGNhbGN1bGF0ZVNjb3JlKGdhbWVEYXRhOiBHYW1lRGF0YSwgbWF0cml4OiBib29sZWFuW11bXSwgc3F1YXNoZWRMaW5lc0NvdW50OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBjb25zdCBmaWVsZEhlaWdodCA9IGdhbWVEYXRhLnNldHRpbmdzLmZpZWxkSGVpZ2h0O1xuICAgICAgICBjb25zdCBmaWVsZFdpZHRoID0gZ2FtZURhdGEuc2V0dGluZ3MuZmllbGRXaWR0aDtcbiAgICAgICAgY29uc3Qgc3F1YXNoZWRMaW5lc1Njb3JlID0gc3F1YXNoZWRMaW5lc0NvdW50ICogNTtcblxuICAgICAgICBjb25zdCBvcmlnaW5hbEhvbGVzQ291bnQgPSB0aGlzLmNhbGN1bGF0ZUhvbGVzKGdhbWVEYXRhLm1hdHJpeCk7XG4gICAgICAgIGNvbnN0IFtob2xlc0NvdW50LCBob2xlc0NvdmVyZWRIZWlnaHRdID0gdGhpcy5jYWxjdWxhdGVIb2xlc0FuZENvdmVyZWRIZWlnaHQobWF0cml4LCBnYW1lRGF0YS5tYXRyaXgpO1xuICAgICAgICBjb25zdCBob2xlc0NvdW50RGVjcmVhc2UgPSBvcmlnaW5hbEhvbGVzQ291bnQgLSBob2xlc0NvdW50O1xuICAgICAgICBsZXQgaG9sZXNTY29yZTogbnVtYmVyO1xuICAgICAgICBpZiAoaG9sZXNDb3ZlcmVkSGVpZ2h0ID09PSAwIHx8IGhvbGVzQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIGhvbGVzU2NvcmUgPSAoaG9sZXNDb3VudERlY3JlYXNlID4gMCA/IGhvbGVzQ291bnREZWNyZWFzZSAqIDE1MCA6IGhvbGVzQ291bnREZWNyZWFzZSAqIDcwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhvbGVzU2NvcmUgPSAoaG9sZXNDb3VudERlY3JlYXNlID4gMCA/IGhvbGVzQ291bnREZWNyZWFzZSAqIDE1MCA6IGhvbGVzQ291bnREZWNyZWFzZSAqIDcwKVxuICAgICAgICAgICAgICAgIC0gaG9sZXNDb3ZlcmVkSGVpZ2h0ICogTWF0aC5wb3coaG9sZXNDb3ZlcmVkSGVpZ2h0LCBob2xlc0NvdmVyZWRIZWlnaHQgLyAoZmllbGRIZWlnaHQgKiBob2xlc0NvdW50KSkgKiA1O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5jYWxjdWxhdGVIZWlnaHQobWF0cml4KTtcbiAgICAgICAgY29uc3QgaGVpZ2h0U2NvcmUgPSAtaGVpZ2h0ICogTWF0aC5wb3coaGVpZ2h0LCBoZWlnaHQgLyBmaWVsZEhlaWdodCkgKiAzO1xuXG4gICAgICAgIGNvbnN0IFtmaWxsYWJsZUNlbGxzQ291bnQsIGZpbGxhYmxlSGVpZ2h0XSA9IHRoaXMuY2FsY3VsYXRlRmlsbGFibGVTcGFjZShtYXRyaXgsIGZpZWxkV2lkdGgpO1xuICAgICAgICBsZXQgZmlsbGFibGVDZWxsc1Njb3JlID0gMDtcbiAgICAgICAgaWYgKGZpbGxhYmxlSGVpZ2h0ID4gNSkge1xuICAgICAgICAgICAgZmlsbGFibGVDZWxsc1Njb3JlID0gLWZpbGxhYmxlQ2VsbHNDb3VudCAqIE1hdGgucG93KGZpbGxhYmxlQ2VsbHNDb3VudCwgZmlsbGFibGVDZWxsc0NvdW50IC8gKGZpZWxkSGVpZ2h0ICogZmllbGRXaWR0aCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgW3R1bm5lbHNTdW1IZWlnaHQsIHR1bm5lbHNDb3VudF0gPSB0aGlzLmNhbGN1bGF0ZVR1bm5lbHNFeGNlcHRVbmNvdmVyZWQobWF0cml4LCBnYW1lRGF0YS5tYXRyaXgpO1xuICAgICAgICBsZXQgdHVubmVsc1Njb3JlOiBudW1iZXI7XG4gICAgICAgIGlmICh0dW5uZWxzQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHR1bm5lbHNTY29yZSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0dW5uZWxzU2NvcmUgPSAtdHVubmVsc0NvdW50ICogNzBcbiAgICAgICAgICAgICAgICAtIHR1bm5lbHNTdW1IZWlnaHQgKiBNYXRoLnBvdyh0dW5uZWxzU3VtSGVpZ2h0LCB0dW5uZWxzU3VtSGVpZ2h0IC8gKGZpZWxkSGVpZ2h0ICogdHVubmVsc0NvdW50KSkgKiA3O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2NvcmUgPSBob2xlc1Njb3JlICsgc3F1YXNoZWRMaW5lc1Njb3JlICsgaGVpZ2h0U2NvcmUgKyB0dW5uZWxzU2NvcmUgKyBmaWxsYWJsZUNlbGxzU2NvcmU7XG4gICAgICAgIGlmIChpc05hTihzY29yZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1hdHJpeCwgaG9sZXNTY29yZSwgc3F1YXNoZWRMaW5lc1Njb3JlLCBoZWlnaHRTY29yZSwgdHVubmVsc1Njb3JlLCBmaWxsYWJsZUNlbGxzU2NvcmUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY29yZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNhbGN1bGF0ZUhvbGVzKGltYWdpbmFibGVNYXRyaXg6IGJvb2xlYW5bXVtdKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IGNvdmVyZWRDb2x1bW5zID0gbmV3IFNldDxudW1iZXI+O1xuICAgICAgICBsZXQgaG9sZXNDb3VudCA9IDA7XG4gICAgICAgIGltYWdpbmFibGVNYXRyaXguZm9yRWFjaCgocm93LCB5KSA9PiB7XG4gICAgICAgICAgICByb3cuZm9yRWFjaCgodmFsLCB4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICBjb3ZlcmVkQ29sdW1ucy5hZGQoeCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3ZlcmVkQ29sdW1ucy5oYXMoeCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9sZXNDb3VudCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhvbGVzQ291bnQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVIb2xlc0FuZENvdmVyZWRIZWlnaHQoaW1hZ2luYWJsZU1hdHJpeDogYm9vbGVhbltdW10sIHJlYWxNYXRyaXg6IGJvb2xlYW5bXVtdKTogW251bWJlciwgbnVtYmVyXSB7XG4gICAgICAgIGNvbnN0IFtvcmlnaW5hbFRoZUhpZ2hlc3RIb2xlWSwgb3JpZ2luYWxUaGVIaWdoZXN0SG9sZUNvdmVyZWRZXSA9IHRoaXMuY2FsY3VsYXRlVGhlSGlnaGVzdEhvbGVDb3ZlcmVkWShyZWFsTWF0cml4KTtcbiAgICAgICAgbGV0IGNvdmVyZWRDb2x1bW5zWXMgPSBuZXcgTWFwPG51bWJlciwgbnVtYmVyPjtcbiAgICAgICAgbGV0IGhvbGVzQ292ZXJlZEhlaWdodHNTdW0gPSAwO1xuICAgICAgICBsZXQgaG9sZXNDb3VudCA9IDA7XG4gICAgICAgIGltYWdpbmFibGVNYXRyaXguZm9yRWFjaCgocm93LCB5KSA9PiB7XG4gICAgICAgICAgICByb3cuZm9yRWFjaCgodmFsLCB4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbCAmJiAhY292ZXJlZENvbHVtbnNZcy5oYXMoeCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY292ZXJlZENvbHVtbnNZcy5zZXQoeCwgeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBjb3ZlcmVkWSA9IGNvdmVyZWRDb2x1bW5zWXMuZ2V0KHgpO1xuICAgICAgICAgICAgICAgIGlmIChjb3ZlcmVkWSAhPT0gdW5kZWZpbmVkICYmICF2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9sZXNDb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3JpZ2luYWxUaGVIaWdoZXN0SG9sZVkgIT09IHVuZGVmaW5lZCAmJiBvcmlnaW5hbFRoZUhpZ2hlc3RIb2xlQ292ZXJlZFkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHkgPCBvcmlnaW5hbFRoZUhpZ2hlc3RIb2xlWSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGVzQ292ZXJlZEhlaWdodHNTdW0gKz0geSAtIGNvdmVyZWRZO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3ZlcmVkWSA8IG9yaWdpbmFsVGhlSGlnaGVzdEhvbGVDb3ZlcmVkWSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvbGVzQ292ZXJlZEhlaWdodHNTdW0gKz0gb3JpZ2luYWxUaGVIaWdoZXN0SG9sZUNvdmVyZWRZIC0gY292ZXJlZFk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBbaG9sZXNDb3VudCwgaG9sZXNDb3ZlcmVkSGVpZ2h0c1N1bV07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVUaGVIaWdoZXN0SG9sZUNvdmVyZWRZKG1hdHJpeDogYm9vbGVhbltdW10pOiBbbnVtYmVyfHVuZGVmaW5lZCwgbnVtYmVyfHVuZGVmaW5lZF0ge1xuICAgICAgICBsZXQgdGhlSGlnaGVzdEhvbGVDb3ZlcmVkWSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IHRoZUhpZ2hlc3RIb2xlWSA9IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IGNvdmVyZWRDb2x1bW5zWXMgPSBuZXcgTWFwPG51bWJlciwgbnVtYmVyPjtcbiAgICAgICAgbWF0cml4LnNvbWUoKHJvdywgeSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJvdy5zb21lKCh2YWwsIHgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsICYmICFjb3ZlcmVkQ29sdW1uc1lzLmhhcyh4KSkge1xuICAgICAgICAgICAgICAgICAgICBjb3ZlcmVkQ29sdW1uc1lzLnNldCh4LCB5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGNvdmVyZWRZID0gY292ZXJlZENvbHVtbnNZcy5nZXQoeCk7XG4gICAgICAgICAgICAgICAgaWYgKGNvdmVyZWRZICE9PSB1bmRlZmluZWQgJiYgIXZhbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGVIaWdoZXN0SG9sZVkgPSB5O1xuICAgICAgICAgICAgICAgICAgICB0aGVIaWdoZXN0SG9sZUNvdmVyZWRZID0gY292ZXJlZFk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBbdGhlSGlnaGVzdEhvbGVZLCB0aGVIaWdoZXN0SG9sZUNvdmVyZWRZXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNhbGN1bGF0ZUhlaWdodChtYXRyaXg6IGJvb2xlYW5bXVtdKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IGxvd2VzdEVtcHR5WSA9IC0xO1xuICAgICAgICBtYXRyaXguZXZlcnkoKHJvdywgeSkgPT4ge1xuICAgICAgICAgICAgaWYgKHJvdy5ldmVyeSh2YWwgPT4gIXZhbCkpIHtcbiAgICAgICAgICAgICAgICBsb3dlc3RFbXB0eVkgPSB5O1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbWF0cml4Lmxlbmd0aCAtIGxvd2VzdEVtcHR5WSAtIDE7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVUdW5uZWxzRXhjZXB0VW5jb3ZlcmVkKGltYWdpbmFibGVNYXRyaXg6IGJvb2xlYW5bXVtdLCByZWFsTWF0cml4OiBib29sZWFuW11bXSk6IFtudW1iZXIsIG51bWJlcl0ge1xuICAgICAgICBsZXQgcmVhbENvdmVyZWRDb2x1bW5zID0gbmV3IFNldDxudW1iZXI+KCk7XG4gICAgICAgIHJlYWxNYXRyaXguZXZlcnkoKHJvdykgPT4ge1xuICAgICAgICAgICAgcm93LmZvckVhY2goKHZhbCwgeCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhbENvdmVyZWRDb2x1bW5zLmFkZCh4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGltYWdpbmFibGVDb3ZlcmVkQ29sdW1ucyA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICAgICAgICBsZXQgdHVubmVscyA9IG5ldyBNYXA8bnVtYmVyLCBudW1iZXI+O1xuICAgICAgICBjb25zdCBmaWVsZFdpZHRoID0gaW1hZ2luYWJsZU1hdHJpeFswXS5sZW5ndGg7XG4gICAgICAgIGltYWdpbmFibGVNYXRyaXguZXZlcnkoKHJvdywgeSkgPT4ge1xuICAgICAgICAgICAgcm93LmZvckVhY2goKHZhbCwgeCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2luYWJsZUNvdmVyZWRDb2x1bW5zLmFkZCh4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJvdy5mb3JFYWNoKCh2YWwsIHgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbFxuICAgICAgICAgICAgICAgICAgICAmJiAhaW1hZ2luYWJsZUNvdmVyZWRDb2x1bW5zLmhhcyh4KVxuICAgICAgICAgICAgICAgICAgICAmJiAhcmVhbENvdmVyZWRDb2x1bW5zLmhhcyh4KVxuICAgICAgICAgICAgICAgICAgICAmJiAoeCA9PT0gMCB8fCBpbWFnaW5hYmxlQ292ZXJlZENvbHVtbnMuaGFzKHggLSAxKSlcbiAgICAgICAgICAgICAgICAgICAgJiYgKHggPT09IGZpZWxkV2lkdGggLSAxIHx8IGltYWdpbmFibGVDb3ZlcmVkQ29sdW1ucy5oYXMoeCArIDEpKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICB0dW5uZWxzLnNldCh4LCAodHVubmVscy5nZXQoeCkgfHwgMCkgKyAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBpbWFnaW5hYmxlQ292ZXJlZENvbHVtbnMuc2l6ZSA8IGZpZWxkV2lkdGg7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgdHVubmVsc1N1bUhlaWdodCA9IDA7XG4gICAgICAgIGxldCB0dW5uZWxzQ291bnQgPSAwO1xuICAgICAgICB0dW5uZWxzLmZvckVhY2goaGVpZ2h0ID0+IHtcbiAgICAgICAgICAgIGlmIChoZWlnaHQgPj0gMykge1xuICAgICAgICAgICAgICAgIHR1bm5lbHNTdW1IZWlnaHQgKz0gaGVpZ2h0O1xuICAgICAgICAgICAgICAgIHR1bm5lbHNDb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFt0dW5uZWxzU3VtSGVpZ2h0LCB0dW5uZWxzQ291bnRdO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2FsY3VsYXRlRmlsbGFibGVTcGFjZShtYXRyaXg6IGJvb2xlYW5bXVtdLCBmaWVsZFdpZHRoOiBudW1iZXIpOiBbbnVtYmVyLCBudW1iZXJdIHtcbiAgICAgICAgbGV0IGNvdmVyZWRDb2x1bW5zID0gbmV3IFNldDxudW1iZXI+KCk7XG4gICAgICAgIGxldCBmaWxsYWJsZUNlbGxzQ291bnQgPSAwO1xuICAgICAgICBsZXQgZmlsbGFibGVIZWlnaHQgPSAwO1xuICAgICAgICBtYXRyaXguZXZlcnkocm93ID0+IHtcbiAgICAgICAgICAgIHJvdy5mb3JFYWNoKCh2YWwsIHgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdmVyZWRDb2x1bW5zLmFkZCh4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJvdy5mb3JFYWNoKCh2YWwsIHgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbCAmJiBjb3ZlcmVkQ29sdW1ucy5zaXplID4gMCAmJiAhY292ZXJlZENvbHVtbnMuaGFzKHgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGxhYmxlQ2VsbHNDb3VudCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGNvdmVyZWRDb2x1bW5zLnNpemUgPCBmaWVsZFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdmVyZWRDb2x1bW5zLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGxhYmxlSGVpZ2h0Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFtmaWxsYWJsZUNlbGxzQ291bnQsIGZpbGxhYmxlSGVpZ2h0XTtcbiAgICB9XG59XG4iLCJpbXBvcnQge0V2ZW50QnVzLCBFdmVudFR5cGUsIEZpZ3VyZXNTcGF3bmVkRXZlbnR9IGZyb20gXCIuLi9UZXRyaXMvRXZlbnRCdXMvRXZlbnRCdXNcIjtcbmltcG9ydCB7Q29tbWFuZEJ1cywgQ29tbWFuZFR5cGUsIEluaXRHYW1lQ29tbWFuZH0gZnJvbSBcIi4uL1RldHJpcy9Db21tYW5kQnVzL0NvbW1hbmRCdXNcIjtcbmltcG9ydCB7RmlndXJlUGxhY2luZ1Jlc29sdmVyfSBmcm9tIFwiLi9GaWd1cmVQbGFjaW5nUmVzb2x2ZXJcIjtcbmltcG9ydCB7RmlndXJlUGxhY2luZ1BlcmZvcm1lcn0gZnJvbSBcIi4vRmlndXJlUGxhY2luZ1BlcmZvcm1lclwiO1xuaW1wb3J0IHtTY29yZUNhbGN1bGF0b3J9IGZyb20gXCIuL1Njb3JlQ2FsY3VsYXRvclwiO1xuXG5leHBvcnQgY2xhc3MgVGV0cmlzU29sdmVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBldmVudEJ1czogRXZlbnRCdXMsXG4gICAgICAgIHByaXZhdGUgY29tbWFuZEJ1czogQ29tbWFuZEJ1cyxcbiAgICAgICAgcHJpdmF0ZSBmYWxsaW5nRmlndXJlUGxhY2luZ1Jlc29sdmVyID0gbmV3IEZpZ3VyZVBsYWNpbmdSZXNvbHZlcihcbiAgICAgICAgICAgIGNvbW1hbmRCdXMsXG4gICAgICAgICAgICBuZXcgU2NvcmVDYWxjdWxhdG9yKCksXG4gICAgICAgICksXG4gICAgICAgIHByaXZhdGUgZmFsbGluZ0ZpZ3VyZXNQbGFjZXIgPSBuZXcgRmlndXJlUGxhY2luZ1BlcmZvcm1lcihjb21tYW5kQnVzKSxcbiAgICApIHtcbiAgICAgICAgdGhpcy5jb21tYW5kQnVzLmFkZEhhbmRsZXIoQ29tbWFuZFR5cGUuSW5pdEdhbWUsIHRoaXMuaW5pdEdhbWVIYW5kbGVyLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdEdhbWVIYW5kbGVyKGNvbW1hbmQ6IEluaXRHYW1lQ29tbWFuZCkge1xuICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKEV2ZW50VHlwZS5GaWd1cmVzU3Bhd25lZCwgdGhpcy5vbkZpZ3VyZXNTcGF3bmVkLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25GaWd1cmVzU3Bhd25lZChldmVudDogRmlndXJlc1NwYXduZWRFdmVudCkge1xuICAgICAgICBjb25zdCB0YXJnZXRGYWxsaW5nRmlndXJlc1N0YXRlcyA9IHRoaXMuZmFsbGluZ0ZpZ3VyZVBsYWNpbmdSZXNvbHZlci5yZXNvbHZlKGV2ZW50LmdhbWVEYXRhKTtcbiAgICAgICAgdGhpcy5mYWxsaW5nRmlndXJlc1BsYWNlci5wbGFjZShldmVudC5nYW1lRGF0YSwgdGFyZ2V0RmFsbGluZ0ZpZ3VyZXNTdGF0ZXMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRldHJpc0ZhY2FkZSB9IGZyb20gJy4vVGV0cmlzL1RldHJpc0ZhY2FkZSdcbmltcG9ydCB7RXZlbnRCdXN9IGZyb20gXCIuL1RldHJpcy9FdmVudEJ1cy9FdmVudEJ1c1wiO1xuaW1wb3J0IHtDb21tYW5kQnVzfSBmcm9tIFwiLi9UZXRyaXMvQ29tbWFuZEJ1cy9Db21tYW5kQnVzXCI7XG5pbXBvcnQge1RldHJpc1NvbHZlcn0gZnJvbSBcIi4vVGV0cmlzU29sdmVyL1RldHJpc1NvbHZlclwiO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgIGNvbnN0IGV2ZW50QnVzID0gbmV3IEV2ZW50QnVzKCk7XG4gICAgY29uc3QgY29tbWFuZEJ1cyA9IG5ldyBDb21tYW5kQnVzKCk7XG4gICAgbGV0IHRldHJpcyA9IG5ldyBUZXRyaXNGYWNhZGUoZXZlbnRCdXMsIGNvbW1hbmRCdXMpO1xuICAgIGxldCBzb2x2ZXIgPSBuZXcgVGV0cmlzU29sdmVyKGV2ZW50QnVzLCBjb21tYW5kQnVzKTtcblxuICAgIHRldHJpcy5zdGFydCgpO1xufSlcbiJdLCJuYW1lcyI6WyJFdmVudFR5cGUiLCJDb21tYW5kVHlwZSIsImdhbWVEYXRhIiwidHJhbnNmZXJyZWRUb01hdHJpeEZpZ3VyZXMiLCJzcXVhc2hlZExpbmVzIiwiZHJvcHBlZExpbmVzIiwiZ2V0RXZlbnRUeXBlIiwiRmFsbGluZ1RpY2tQcm9jZXNzZWQiLCJHYW1lT3ZlciIsIkZpZ3VyZXNNb3ZlZCIsIm5ld0ZpZ3VyZXMiLCJGaWd1cmVzU3Bhd25lZCIsImhhbmRsZXJzIiwiTWFwIiwib24iLCJldmVudCIsImhhbmRsZXIiLCJ1bmlxdWUiLCJ0aGlzIiwiZ2V0Iiwic29tZSIsImJvdW5kSGFuZGxlciIsInB1c2giLCJzZXQiLCJvZmYiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJmaXJlIiwiZXZlbnRQYXlsb2FkIiwiZm9yRWFjaCIsIkZpZ3VyZVR1cm5TdGF0ZSIsImdldENvbW1hbmRUeXBlIiwiSW5pdEdhbWUiLCJSZXN1bWVHYW1lIiwiUGF1c2VHYW1lIiwiRmlndXJlc0ZhbGxUaWNrIiwiUmVuZGVyIiwiTW92ZUxlZnQiLCJNb3ZlUmlnaHQiLCJUdXJuQ2xvY2t3aXNlIiwiTW92ZURvd24iLCJGaWd1cmVzRmFsbERvd24iLCJhZGRIYW5kbGVyIiwicmVtb3ZlSGFuZGxlciIsInJ1biIsInBheWxvYWQiLCJQdXNoSW5EaXJlY3Rpb24iLCJnZXROb3JtYWxpemVkRmlndXJlIiwiZmlndXJlIiwiZ2V0RmlndXJlIiwidGhlTG9uZ2VzdFJvd1NpemUiLCJyZWR1Y2UiLCJwcmV2aW91cyIsImN1cnJlbnQiLCJNYXRoIiwibWF4IiwibGVuZ3RoIiwibWFwIiwicm93Iiwib3JpZ2luYWxMZW5ndGgiLCJmaWxsIiwiZ2V0Rmlyc3RUdXJuIiwiZ2V0U2Vjb25kVHVybiIsIm9yaWdpbmFsRmlndXJlIiwidHVybmVkRmlndXJlIiwib3JpZ2luYWxGaWd1cmVIZWlnaHQiLCJvcmlnaW5hbEZpZ3VyZVdpZHRoIiwieCIsIkFycmF5IiwieSIsImdldFRoaXJkVHVybiIsInJldmVyc2UiLCJnZXRGb3J0aFR1cm4iLCJnZXRUdXJuIiwiZmlndXJlVHVyblN0YXRlIiwiT25lIiwiVHdvIiwiVGhyZWUiLCJGb3VyIiwic3BsaXQiLCJpdGVtIiwiU2ltcGx5Um90YXRhYmxlRmlndXJlIiwicG9zaXRpb24iLCJ0dXJuU3RhdGUiLCJjb2xvciIsImZpZWxkV2lkdGgiLCJmaWVsZEhlaWdodCIsImZpZ3VyZXMiLCJmaWd1cmVzRmFsbGVuIiwibGluZXNTcXVhc2hlZCIsImlzSW5pdGlhbGl6ZWQiLCJpc0dhbWVPdmVyIiwiZmFsbGluZ0ZpZ3VyZXMiLCJtYXRyaXgiLCJuZXh0VGlja1RpbWVvdXRJZCIsInNldHRpbmdzIiwibGV2ZWwiLCJzY29yZSIsImNvbWJvIiwic3RhdHMiLCJzZXRUaW1lb3V0IiwiU3RhdHMiLCJtYWtlU2ltcGxlIiwid2lkdGgiLCJoZWlnaHQiLCJHYW1lRGF0YSIsIl8iLCJHYW1lU2V0dGluZ3MiLCJURmlndXJlIiwiUmlnaHRMRmlndXJlIiwiTGVmdExGaWd1cmUiLCJTcXVhcmVGaWd1cmUiLCJTdGlja0ZpZ3VyZSIsIkxaRmlndXJlIiwiUlpGaWd1cmUiLCJ0aW1pbmdzSGFuZGxlciIsImV2ZW50QnVzIiwiY29tbWFuZEJ1cyIsImluaXRHYW1lSGFuZGxlciIsImJpbmQiLCJyZXN1bWVHYW1lSGFuZGxlciIsInBhdXNlR2FtZUhhbmRsZXIiLCJnYW1lT3ZlckhhbmRsZXIiLCJjb21tYW5kIiwib25GYWxsVGlja1Byb2Nlc3NlZCIsIkluaXRHYW1lQ29tbWFuZCIsImZhbGxUaWNrIiwiY2xlYXJUaW1lb3V0IiwiUmVuZGVyQ29tbWFuZCIsIkdhbWVPdmVyRXZlbnQiLCJGaWd1cmVzRmFsbFRpY2tDb21tYW5kIiwiZ2V0RGVsYXlGb3JOZXh0VGlja01zIiwiY2FuRmlndXJlQmVQbGFjZWQiLCJ0YXJnZXRGaWd1cmVNYXRyaXgiLCJ0YXJnZXRQb3NpdGlvbiIsImV2ZXJ5IiwidmFsdWUiLCJyZWFsWSIsInJlYWxYIiwiZmlsbGVkIiwiZmlsbGVkR2FtZU92ZXIiLCJlbXB0eSIsImNvbnRhaW5lckVsZW1lbnQiLCJyZW5kZXJQcm9qZWN0aW9uRmlndXJlcyIsIm1hdHJpeENlbGxDb2xvcnMiLCJmYWxsaW5nRmlndXJlQ2VsbENvbG9ycyIsInByb2plY3Rpb25GaWd1cmVDZWxsQ29sb3JzIiwiVGFibGVSZW5kZXJlckNlbGxDb2xvclNldHRpbmdzIiwicmVuZGVyU2V0dGluZ3MiLCJjZWxsc0h0bWxFbGVtZW50c01hcCIsImluaXRIYW5kbGVyIiwicmVuZGVyQ29tbWFuZEhhbmRsZXIiLCJ0YWJsZSIsIlRhYmxlUmVuZGVyZXIiLCJjcmVhdGVIdG1sRWxlbWVudCIsImNlbGwiLCJhcHBlbmRDaGlsZCIsImlubmVySFRNTCIsInNjb3JlRGlzcGxheSIsIm9uR2FtZU92ZXIiLCJvbkZpZ3VyZXNNb3ZlZCIsInJlbmRlclN0YXRlIiwicmVwYWludE1hdHJpeENlbGxzIiwiQ29vcmRpbmF0ZSIsInJlbmRlckZhbGxpbmdGaWd1cmVzUHJvamVjdGlvbiIsInJlbmRlckZhbGxpbmdGaWd1cmVzIiwicmVuZGVyU3RhdHMiLCJmYWxsaW5nRmlndXJlIiwicmVwYWludEZhbGxpbmdGaWd1cmVzQ2VsbHMiLCJmaWd1cmVNYXRyaXgiLCJwcm9qZWN0aW9uRmlndXJlWCIsInByb2plY3Rpb25GaWd1cmVZIiwiRmlndXJlUGxhY2luZ0NoZWNrZXIiLCJyZXBhaW50UHJvamVjdGlvbkZpZ3VyZXNDZWxscyIsImluZGVudCIsImNvbG9ycyIsIkNlbGxDb2xvcnMiLCJyZXBhaW50Q2VsbHMiLCJjZWxsQ29sb3JzIiwic3R5bGUiLCJiYWNrZ3JvdW5kIiwibGV2ZWxTcGFuIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNjb3JlU3BhbiIsImNvbWJvU3BhbiIsInRvU3RyaW5nIiwiaHRtbCIsImNvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJjaGlsZHJlbiIsImZpcnN0RWxlbWVudENoaWxkIiwiSFRNTEVsZW1lbnQiLCJ0cmFuc2ZlcnJlZEZpZ3VyZXMiLCJwcm9jZXNzRmlndXJlc0ZhbGxUaWNrQ29tbWFuZCIsInByb2Nlc3NEcm9wRmlndXJlc0NvbW1hbmQiLCJmYWxsaW5nUmVzdWx0IiwiZmFsbEZpZ3VyZXNGb3JPbmVDZWxsIiwic3F1YXNoTGluZXMiLCJHYW1lT3ZlckNvbW1hbmQiLCJGYWxsVGlja1Byb2Nlc3NlZEV2ZW50IiwiRmFsbGluZ1Jlc3VsdCIsIm9uZUNlbGxGYWxsaW5nUmVzdWx0IiwiZmlndXJlQ2FuRmFsbCIsImZpZ3VyZUdhbWVPdmVyUmVzdWx0IiwidHJhbnNmZXJGaWd1cmVUb01hdHJpeCIsImZpZ3VyZUNlbGxZIiwiY2VsbFZhbHVlIiwiZmlndXJlQ2VsbFgiLCJtYXRyaXhYIiwibWF0cml4WSIsImxpbmVzVG9TcXVhc2giLCJ1bnNoaWZ0IiwiVG9BcnJheSIsInZhbCIsIk9iamVjdCIsImtleXMiLCJuIiwiTnVtYmVyIiwicGFyc2VJbnQiLCJmaWx0ZXIiLCJpc05hTiIsIkdldFJhbmRvbSIsInZhbHVlcyIsIkVudW1IZWxwZXIiLCJmbG9vciIsInJhbmRvbSIsInByb2Nlc3NPbkZhbGxUaWNrIiwiYWRkRmlndXJlIiwiZmlndXJlSW5kZXgiLCJmaWd1cmVXaWR0aCIsImNvb3JkaW5hdGUiLCJjZWlsIiwiRmFsbGluZ0ZpZ3VyZSIsIkZpZ3VyZXNTcGF3bmVkRXZlbnQiLCJwcm9jZXNzTW92ZUxlZnRDb21tYW5kIiwicHJvY2Vzc01vdmVSaWdodENvbW1hbmQiLCJwcm9jZXNzTW92ZURvd25Db21tYW5kIiwicHJvY2Vzc1R1cm5DbG9ja3dpc2VDb21tYW5kIiwiRmlndXJlc01vdmVkRXZlbnQiLCJhbGxUdXJuU3RhdGVzIiwibmV4dFR1cm5TdGF0ZSIsInByb2Nlc3NJbml0R2FtZUNvbW1hbmQiLCJ3aW5kb3ciLCJvbmtleWRvd24iLCJjb2RlIiwiTW92ZUxlZnRDb21tYW5kIiwiTW92ZVJpZ2h0Q29tbWFuZCIsIlR1cm5DbG9ja3dpc2VDb21tYW5kIiwiTW92ZURvd25Db21tYW5kIiwiRHJvcEZpZ3VyZXNDb21tYW5kIiwic3F1YXNoZWRSb3dzUmV3YXJkVGhyZXNob2xkc01hcCIsInJld2FyZE9uQ29tYm8iLCJvbkZhbGxpbmdUaWNrUHJvY2Vzc2VkIiwicHJldmlvdXNUaHJlc2hvbGRSZXdhcmQiLCJyZXdhcmQiLCJyb3dzU3F1YXNoZWRUaHJlc2hvbGQiLCJsZXZlbEluY3JlYXNlT25TcXVhc2hlZFJvd3NOdW1iZXIiLCJtYXhMZXZlbHMiLCJzcXVhc2hlZFJvd3NDb3VudGVyIiwibWluIiwiZGVsYXlNcyIsImdhbWVDb250cm9sbGVyIiwibW92aW5nSGFuZGxlciIsIm1vdmluZ0NvbnRyb2xsZXIiLCJmYWxsaW5nRmlndXJlc1Byb2Nlc3NvciIsImZpZ3VyZXNTcGF3bmVyIiwibGV2ZWxDb3VudGVyIiwiY29tYm9Db3VudGVyIiwic2NvcmVDb3VudGVyIiwic3RhdHNDb3VudGVyIiwidGFibGVSZW5kZXJlciIsIkV2ZW50QnVzIiwiQ29tbWFuZEJ1cyIsIkdhbWVDb250cm9sbGVyIiwiQ29uc3RUaW1pbmdzSGFuZGxlciIsIk1vdmluZ0hhbmRsZXIiLCJNb3ZpbmdDb250cm9sbGVyIiwiUmVndWxhckZhbGxpbmdGaWd1cmVzUHJvY2Vzc29yIiwiQWx3YXlzT25lRmlndXJlU3Bhd25lciIsIlNxdWFzaGVkUm93c0NvdW50ZXJCYXNlZExldmVsQ291bnRlciIsIkNvbWJvQ291bnRlciIsIkZhbGxUaWNrU2NvcmVDb3VudGVyIiwiU3RhdHNDb3VudGVyIiwiVGFibGVSZW5kZXJlclNldHRpbmdzIiwiYm9keSIsInN0YXJ0IiwiUmVzdW1lR2FtZUNvbW1hbmQiLCJyZXN1bWUiLCJwYXVzZSIsIlBhdXNlR2FtZUNvbW1hbmQiLCJmaWd1cmVzVGFyZ2V0U3RhdGVzIiwicHVzaEluRGlyZWN0aW9uIiwiRXJyb3IiLCJzY29yZUNhbGN1bGF0b3IiLCJyZXNvbHZlIiwiR2FtZVN0YXRlTm90U3VwcG9ydGVkRXJyb3IiLCJtYXhTY29yZSIsInRoZUJlc3RSZXN1bHQiLCJGaWd1cmVQbGFjaW5nUmVzdWx0IiwidW5kZWZpbmVkIiwicHJvY2Vzc1N0YXRlcyIsImZha2VGaWd1cmUiLCJkZWJ1Z01vZGUiLCJzdHJ1Y3R1cmVkQ2xvbmUiLCJjYWxsYmFjayIsImVudW1zIiwicG9wIiwibWF0cmljZXMiLCJpbWFnaW5lRmlndXJlRHJvcCIsImltYWdpbmFibGVNYXRyaXgiLCJzcXVhc2hlZExpbmVzQ291bnQiLCJjYWxjdWxhdGVTY29yZSIsImltYWdpbmFibGVSZXN1bHQiLCJpbWFnaW5lRmlndXJlUHVzaEluIiwiZ2FtZU1hdHJpeCIsInRhcmdldFgiLCJ0YXJnZXRZIiwiZmlndXJlWSIsImZpZ3VyZVgiLCJpbml0aWFsRGVsYXlNcyIsImJhc2UiLCJwb3ciLCJQbGFjaW5nRXJyb3IiLCJMZXZlbEJhc2VkVGltaW5nc0hhbmRsZXIiLCJuZXh0TW92ZVRpbWVvdXRJZCIsInBsYWNlIiwidGFyZ2V0U3RhdGUiLCJwcm9jZXNzVGljayIsInRhcmdldEZpZ3VyZSIsIkluY29uc2lzdGVudFRhcmdldFN0YXRlRXJyb3IiLCJob2xlc1Njb3JlIiwic3F1YXNoZWRMaW5lc1Njb3JlIiwib3JpZ2luYWxIb2xlc0NvdW50IiwiY2FsY3VsYXRlSG9sZXMiLCJjYWxjdWxhdGVIb2xlc0FuZENvdmVyZWRIZWlnaHQiLCJob2xlc0NvdW50IiwiaG9sZXNDb3ZlcmVkSGVpZ2h0IiwiaG9sZXNDb3VudERlY3JlYXNlIiwiY2FsY3VsYXRlSGVpZ2h0IiwiaGVpZ2h0U2NvcmUiLCJjYWxjdWxhdGVGaWxsYWJsZVNwYWNlIiwiZmlsbGFibGVDZWxsc0NvdW50IiwiZmlsbGFibGVDZWxsc1Njb3JlIiwidHVubmVsc1Njb3JlIiwiY2FsY3VsYXRlVHVubmVsc0V4Y2VwdFVuY292ZXJlZCIsInR1bm5lbHNTdW1IZWlnaHQiLCJ0dW5uZWxzQ291bnQiLCJjb25zb2xlIiwibG9nIiwiY292ZXJlZENvbHVtbnMiLCJTZXQiLCJhZGQiLCJoYXMiLCJyZWFsTWF0cml4IiwiY2FsY3VsYXRlVGhlSGlnaGVzdEhvbGVDb3ZlcmVkWSIsIm9yaWdpbmFsVGhlSGlnaGVzdEhvbGVZIiwib3JpZ2luYWxUaGVIaWdoZXN0SG9sZUNvdmVyZWRZIiwiY292ZXJlZENvbHVtbnNZcyIsImhvbGVzQ292ZXJlZEhlaWdodHNTdW0iLCJjb3ZlcmVkWSIsInRoZUhpZ2hlc3RIb2xlQ292ZXJlZFkiLCJ0aGVIaWdoZXN0SG9sZVkiLCJsb3dlc3RFbXB0eVkiLCJyZWFsQ292ZXJlZENvbHVtbnMiLCJpbWFnaW5hYmxlQ292ZXJlZENvbHVtbnMiLCJ0dW5uZWxzIiwic2l6ZSIsImZpbGxhYmxlSGVpZ2h0IiwiZmFsbGluZ0ZpZ3VyZVBsYWNpbmdSZXNvbHZlciIsImZhbGxpbmdGaWd1cmVzUGxhY2VyIiwiRmlndXJlUGxhY2luZ1Jlc29sdmVyIiwiU2NvcmVDYWxjdWxhdG9yIiwiRmlndXJlUGxhY2luZ1BlcmZvcm1lciIsIm9uRmlndXJlc1NwYXduZWQiLCJ0YXJnZXRGYWxsaW5nRmlndXJlc1N0YXRlcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0ZXRyaXMiLCJUZXRyaXNGYWNhZGUiLCJUZXRyaXNTb2x2ZXIiXSwic291cmNlUm9vdCI6IiJ9